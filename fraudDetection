{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "from sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\n",
    "from sklearn.metrics import mean_squared_error, r2_score, roc_auc_score\n",
    "import matplotlib.pyplot as plt\n",
    "from sklearn.preprocessing import scale\n",
    "from sklearn import model_selection\n",
    "from sklearn.tree import DecisionTreeRegressor, DecisionTreeClassifier\n",
    "from sklearn.neighbors import KNeighborsRegressor\n",
    "from sklearn.ensemble import BaggingRegressor\n",
    "\n",
    "from warnings import filterwarnings\n",
    "filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "sample_submission = pd.read_csv('sample_submission.csv', index_col='TransactionID')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_identity = pd.read_csv('train_identity.csv', index_col='TransactionID')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(144233, 40)"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_identity.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_transaction = pd.read_csv('train_transaction.csv', index_col='TransactionID')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(590540, 393)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_transaction.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "test_transaction = pd.read_csv('test_transaction.csv', index_col='TransactionID')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "test_identity = pd.read_csv('test_identity.csv', index_col='TransactionID')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "train = train_transaction.merge(train_identity, how='left', left_index=True, right_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "test = test_transaction.merge(test_identity, how='left', left_index=True, right_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_train_full = train_transaction['isFraud'].copy()\n",
    "X_train_full = train_transaction.drop('isFraud', axis=1)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_test = test_transaction.copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>isFraud</th>\n",
       "      <th>TransactionDT</th>\n",
       "      <th>TransactionAmt</th>\n",
       "      <th>ProductCD</th>\n",
       "      <th>card1</th>\n",
       "      <th>card2</th>\n",
       "      <th>card3</th>\n",
       "      <th>card4</th>\n",
       "      <th>card5</th>\n",
       "      <th>card6</th>\n",
       "      <th>...</th>\n",
       "      <th>V330</th>\n",
       "      <th>V331</th>\n",
       "      <th>V332</th>\n",
       "      <th>V333</th>\n",
       "      <th>V334</th>\n",
       "      <th>V335</th>\n",
       "      <th>V336</th>\n",
       "      <th>V337</th>\n",
       "      <th>V338</th>\n",
       "      <th>V339</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TransactionID</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2987000</th>\n",
       "      <td>0</td>\n",
       "      <td>86400</td>\n",
       "      <td>68.5</td>\n",
       "      <td>W</td>\n",
       "      <td>13926</td>\n",
       "      <td>NaN</td>\n",
       "      <td>150.0</td>\n",
       "      <td>discover</td>\n",
       "      <td>142.0</td>\n",
       "      <td>credit</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2987001</th>\n",
       "      <td>0</td>\n",
       "      <td>86401</td>\n",
       "      <td>29.0</td>\n",
       "      <td>W</td>\n",
       "      <td>2755</td>\n",
       "      <td>404.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>mastercard</td>\n",
       "      <td>102.0</td>\n",
       "      <td>credit</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2987002</th>\n",
       "      <td>0</td>\n",
       "      <td>86469</td>\n",
       "      <td>59.0</td>\n",
       "      <td>W</td>\n",
       "      <td>4663</td>\n",
       "      <td>490.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>visa</td>\n",
       "      <td>166.0</td>\n",
       "      <td>debit</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2987003</th>\n",
       "      <td>0</td>\n",
       "      <td>86499</td>\n",
       "      <td>50.0</td>\n",
       "      <td>W</td>\n",
       "      <td>18132</td>\n",
       "      <td>567.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>mastercard</td>\n",
       "      <td>117.0</td>\n",
       "      <td>debit</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2987004</th>\n",
       "      <td>0</td>\n",
       "      <td>86506</td>\n",
       "      <td>50.0</td>\n",
       "      <td>H</td>\n",
       "      <td>4497</td>\n",
       "      <td>514.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>mastercard</td>\n",
       "      <td>102.0</td>\n",
       "      <td>credit</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 393 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               isFraud  TransactionDT  TransactionAmt ProductCD  card1  card2  \\\n",
       "TransactionID                                                                   \n",
       "2987000              0          86400            68.5         W  13926    NaN   \n",
       "2987001              0          86401            29.0         W   2755  404.0   \n",
       "2987002              0          86469            59.0         W   4663  490.0   \n",
       "2987003              0          86499            50.0         W  18132  567.0   \n",
       "2987004              0          86506            50.0         H   4497  514.0   \n",
       "\n",
       "               card3       card4  card5   card6  ...  V330  V331  V332  V333  \\\n",
       "TransactionID                                    ...                           \n",
       "2987000        150.0    discover  142.0  credit  ...   NaN   NaN   NaN   NaN   \n",
       "2987001        150.0  mastercard  102.0  credit  ...   NaN   NaN   NaN   NaN   \n",
       "2987002        150.0        visa  166.0   debit  ...   NaN   NaN   NaN   NaN   \n",
       "2987003        150.0  mastercard  117.0   debit  ...   NaN   NaN   NaN   NaN   \n",
       "2987004        150.0  mastercard  102.0  credit  ...   0.0   0.0   0.0   0.0   \n",
       "\n",
       "              V334 V335  V336  V337  V338  V339  \n",
       "TransactionID                                    \n",
       "2987000        NaN  NaN   NaN   NaN   NaN   NaN  \n",
       "2987001        NaN  NaN   NaN   NaN   NaN   NaN  \n",
       "2987002        NaN  NaN   NaN   NaN   NaN   NaN  \n",
       "2987003        NaN  NaN   NaN   NaN   NaN   NaN  \n",
       "2987004        0.0  0.0   0.0   0.0   0.0   0.0  \n",
       "\n",
       "[5 rows x 393 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_transaction.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "del train_transaction, train_identity, test_transaction, test_identity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train_full = X_train_full.fillna(-999)\n",
    "X_test = X_test.fillna(-999)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 590540 entries, 2987000 to 3577539\n",
      "Columns: 392 entries, TransactionDT to V339\n",
      "dtypes: float64(376), int64(2), object(14)\n",
      "memory usage: 1.7+ GB\n"
     ]
    }
   ],
   "source": [
    "X_train_full.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TransactionDT</th>\n",
       "      <th>TransactionAmt</th>\n",
       "      <th>ProductCD</th>\n",
       "      <th>card1</th>\n",
       "      <th>card2</th>\n",
       "      <th>card3</th>\n",
       "      <th>card4</th>\n",
       "      <th>card5</th>\n",
       "      <th>card6</th>\n",
       "      <th>addr1</th>\n",
       "      <th>...</th>\n",
       "      <th>V330</th>\n",
       "      <th>V331</th>\n",
       "      <th>V332</th>\n",
       "      <th>V333</th>\n",
       "      <th>V334</th>\n",
       "      <th>V335</th>\n",
       "      <th>V336</th>\n",
       "      <th>V337</th>\n",
       "      <th>V338</th>\n",
       "      <th>V339</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TransactionID</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2987000</th>\n",
       "      <td>86400</td>\n",
       "      <td>68.5</td>\n",
       "      <td>W</td>\n",
       "      <td>13926</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>discover</td>\n",
       "      <td>142.0</td>\n",
       "      <td>credit</td>\n",
       "      <td>315.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2987001</th>\n",
       "      <td>86401</td>\n",
       "      <td>29.0</td>\n",
       "      <td>W</td>\n",
       "      <td>2755</td>\n",
       "      <td>404.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>mastercard</td>\n",
       "      <td>102.0</td>\n",
       "      <td>credit</td>\n",
       "      <td>325.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2987002</th>\n",
       "      <td>86469</td>\n",
       "      <td>59.0</td>\n",
       "      <td>W</td>\n",
       "      <td>4663</td>\n",
       "      <td>490.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>visa</td>\n",
       "      <td>166.0</td>\n",
       "      <td>debit</td>\n",
       "      <td>330.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2987003</th>\n",
       "      <td>86499</td>\n",
       "      <td>50.0</td>\n",
       "      <td>W</td>\n",
       "      <td>18132</td>\n",
       "      <td>567.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>mastercard</td>\n",
       "      <td>117.0</td>\n",
       "      <td>debit</td>\n",
       "      <td>476.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2987004</th>\n",
       "      <td>86506</td>\n",
       "      <td>50.0</td>\n",
       "      <td>H</td>\n",
       "      <td>4497</td>\n",
       "      <td>514.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>mastercard</td>\n",
       "      <td>102.0</td>\n",
       "      <td>credit</td>\n",
       "      <td>420.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 392 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               TransactionDT  TransactionAmt ProductCD  card1  card2  card3  \\\n",
       "TransactionID                                                                 \n",
       "2987000                86400            68.5         W  13926 -999.0  150.0   \n",
       "2987001                86401            29.0         W   2755  404.0  150.0   \n",
       "2987002                86469            59.0         W   4663  490.0  150.0   \n",
       "2987003                86499            50.0         W  18132  567.0  150.0   \n",
       "2987004                86506            50.0         H   4497  514.0  150.0   \n",
       "\n",
       "                    card4  card5   card6  addr1  ...   V330   V331   V332  \\\n",
       "TransactionID                                    ...                        \n",
       "2987000          discover  142.0  credit  315.0  ... -999.0 -999.0 -999.0   \n",
       "2987001        mastercard  102.0  credit  325.0  ... -999.0 -999.0 -999.0   \n",
       "2987002              visa  166.0   debit  330.0  ... -999.0 -999.0 -999.0   \n",
       "2987003        mastercard  117.0   debit  476.0  ... -999.0 -999.0 -999.0   \n",
       "2987004        mastercard  102.0  credit  420.0  ...    0.0    0.0    0.0   \n",
       "\n",
       "                V333   V334   V335   V336   V337   V338   V339  \n",
       "TransactionID                                                   \n",
       "2987000       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "2987001       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "2987002       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "2987003       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "2987004          0.0    0.0    0.0    0.0    0.0    0.0    0.0  \n",
       "\n",
       "[5 rows x 392 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train_full.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Using TensorFlow backend.\n"
     ]
    }
   ],
   "source": [
    "from imblearn.over_sampling import SMOTE"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Label Encoding"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn import preprocessing\n",
    "\n",
    "for feature in X_train_full.columns:\n",
    "    if X_train_full[feature].dtype=='object' or X_test[feature].dtype=='object' :\n",
    "        lbl = preprocessing.LabelEncoder()\n",
    "        lbl.fit(list(X_train_full[feature].values) + list(X_test[feature].values))\n",
    "        X_train_full[feature] = lbl.transform(list(X_train_full[feature].values))\n",
    "        X_test[feature] = lbl.transform(list(X_test[feature].values))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_smote, y_smote = SMOTE().fit_sample(X_train_full, y_train_full)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_smote = pd.DataFrame(X_smote)\n",
    "y_smote = pd.DataFrame(y_smote)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    569877\n",
       "1     20663\n",
       "Name: isFraud, dtype: int64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_train_full.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1    569877\n",
       "0    569877\n",
       "Name: isFraud, dtype: int64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_smote.iloc[:,0].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train, X_val, Y_train, Y_val = train_test_split(X_smote, y_smote,\n",
    "                                                 test_size=0.2,\n",
    "                                                 random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train, X_val, Y_train, Y_val = train_test_split(X_train_full, y_train_full,\n",
    "                                                 test_size=0.2,\n",
    "                                                 random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "del X_train_full, y_train_full"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_smote, y_smote = SMOTE().fit_sample(X_train, Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_smote = pd.DataFrame(X_smote)\n",
    "y_smote = pd.DataFrame(y_smote)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "from imblearn.under_sampling import RandomUnderSampler\n",
    "from imblearn.over_sampling import RandomOverSampler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "rus = RandomOverSampler()\n",
    "X_rs, y_rs = rus.fit_sample(X_train, Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1    456011\n",
       "0    456011\n",
       "Name: isFraud, dtype: int64"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_rs.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(912022, 392)"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_rs.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 1min 34s, sys: 5.16 s, total: 1min 39s\n",
      "Wall time: 31.3 s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,\n",
       "                   intercept_scaling=1, l1_ratio=None, max_iter=100,\n",
       "                   multi_class='auto', n_jobs=None, penalty='l2',\n",
       "                   random_state=None, solver='lbfgs', tol=0.0001, verbose=0,\n",
       "                   warm_start=False)"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from time import time\n",
    "\n",
    "\n",
    "\n",
    "#Logistic regression\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "lr = LogisticRegression()\n",
    "\n",
    "%time lr.fit(X_train, Y_train)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Square root of error squares 0.1846298212258908\n",
      "Roc Auc Score: 0.6673658122491153\n"
     ]
    }
   ],
   "source": [
    "print(\"Square root of error squares\", np.sqrt(mean_squared_error(Y_val, lr.predict_proba(X_val)[:,1])))\n",
    "print(\"Roc Auc Score:\",roc_auc_score(Y_val, lr.predict_proba(X_val)[:,1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ACC Score: 0.9640752531581265\n",
      "Precision: 0.45454545454545453\n",
      "Recall: 0.0011786892975011788\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import accuracy_score, precision_score, recall_score\n",
    "print(\"ACC Score:\",accuracy_score(Y_val, lr.predict(X_val)))\n",
    "print(\"Precision:\",precision_score(Y_val, lr.predict(X_val)))\n",
    "print(\"Recall:\",recall_score(Y_val, lr.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.metrics import confusion_matrix, classification_report\n",
    "import seaborn as sns\n",
    "cm = confusion_matrix(Y_val, lr.predict(X_val))\n",
    "sns.heatmap(cm, annot=True, fmt='.0f')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.96      1.00      0.98    113866\n",
      "           1       0.45      0.00      0.00      4242\n",
      "\n",
      "    accuracy                           0.96    118108\n",
      "   macro avg       0.71      0.50      0.49    118108\n",
      "weighted avg       0.95      0.96      0.95    118108\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(Y_val, lr.predict_proba(X_val)[:,1].round()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ACC Score: 0.6743071975994841\n",
      "Precision: 0.7400625279142474\n",
      "Recall: 0.5377180595876053\n"
     ]
    }
   ],
   "source": [
    "#SMOTE\n",
    "print(\"ACC Score:\",accuracy_score(Y_val, lr.predict(X_val)))\n",
    "print(\"Precision:\",precision_score(Y_val, lr.predict(X_val)))\n",
    "print(\"Recall:\",recall_score(Y_val, lr.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.metrics import confusion_matrix, classification_report\n",
    "import seaborn as sns\n",
    "cm = confusion_matrix(Y_val, lr.predict(X_val))\n",
    "sns.heatmap(cm, annot=True, fmt='.0f')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.64      0.81      0.71    113934\n",
      "           1       0.74      0.54      0.62    114017\n",
      "\n",
      "    accuracy                           0.67    227951\n",
      "   macro avg       0.69      0.67      0.67    227951\n",
      "weighted avg       0.69      0.67      0.67    227951\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(Y_val, lr.predict_proba(X_val)[:,1].round()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "#XGBoost model\n",
    "import xgboost as xgb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "clf = xgb.XGBClassifier(\n",
    "    n_esitmators=500,\n",
    "    max_depth=9,\n",
    "    learning_rate=0.05,\n",
    "    subsample=0.9,\n",
    "    colsample_bytree=0.9,\n",
    "    missing=-999,\n",
    "    random_state=2019,\n",
    "    tree_method='hist'\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[11:35:42] WARNING: /Users/runner/miniforge3/conda-bld/xgboost_1598185652448/work/src/learner.cc:516: \n",
      "Parameters: { n_esitmators } might not be used.\n",
      "\n",
      "  This may not be accurate due to some parameters are only used in language bindings but\n",
      "  passed down to XGBoost core.  Or some parameters are not used but slip through this\n",
      "  verification. Please open an issue if you find above cases.\n",
      "\n",
      "\n",
      "CPU times: user 3min 6s, sys: 8.56 s, total: 3min 14s\n",
      "Wall time: 36.4 s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,\n",
       "              colsample_bynode=1, colsample_bytree=0.9, gamma=0, gpu_id=-1,\n",
       "              importance_type='gain', interaction_constraints='',\n",
       "              learning_rate=0.05, max_delta_step=0, max_depth=9,\n",
       "              min_child_weight=1, missing=-999, monotone_constraints='()',\n",
       "              n_esitmators=500, n_estimators=100, n_jobs=0, num_parallel_tree=1,\n",
       "              objective='binary:logistic', random_state=2019, reg_alpha=0,\n",
       "              reg_lambda=1, scale_pos_weight=1, subsample=0.9,\n",
       "              tree_method='hist', validate_parameters=1, verbosity=None)"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time clf.fit(X_train, Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Square root of error squares 0.14630153309184382\n",
      "Roc Auc Score: 0.7153042485822915\n"
     ]
    }
   ],
   "source": [
    "print(\"Square root of error squares\", np.sqrt(mean_squared_error(Y_val, clf.predict(X_val))))\n",
    "print(\"Roc Auc Score:\",roc_auc_score(Y_val, clf.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ACC Score: 0.9785958614149761\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import accuracy_score\n",
    "print(\"ACC Score:\",accuracy_score(Y_val, clf.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1.03704626e-08])"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lr.intercept_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[ 3.94552184e-08,  9.55911637e-06, -1.17607489e-07,\n",
       "        -2.42441453e-05,  1.14487765e-06,  3.15395153e-06,\n",
       "        -5.28380063e-09,  1.68425730e-07, -6.37853872e-08,\n",
       "        -4.47548364e-05, -3.99357421e-05, -1.74947872e-05,\n",
       "         4.17830428e-06,  3.06192501e-08,  5.92499915e-07,\n",
       "         3.78637465e-06,  5.37896710e-06, -2.05191473e-09,\n",
       "         1.77025435e-06, -7.94379384e-07,  1.27525135e-06,\n",
       "         1.66381019e-06,  2.82453577e-06, -4.44000661e-07,\n",
       "         2.44381653e-06,  2.34839712e-06,  2.69949231e-06,\n",
       "        -1.58818456e-06,  2.10876374e-07, -1.10663961e-05,\n",
       "        -2.83159256e-05, -2.72851693e-06, -3.97504021e-06,\n",
       "         1.57947359e-05,  2.25353378e-05,  2.39751611e-05,\n",
       "         2.13630665e-05,  2.40206872e-05, -9.27058392e-06,\n",
       "        -3.74738363e-05,  2.70693597e-05,  1.66456870e-05,\n",
       "         2.18075490e-05, -1.33767890e-05, -5.80884061e-08,\n",
       "        -7.46713217e-08, -8.14901072e-08,  1.00152707e-07,\n",
       "         2.01754206e-08, -7.59996271e-08, -4.82478037e-08,\n",
       "        -6.19883124e-08, -6.95541106e-08, -2.84943636e-05,\n",
       "        -2.84917659e-05, -2.84839684e-05, -2.84864826e-05,\n",
       "        -2.84779768e-05, -2.84934763e-05, -2.84905197e-05,\n",
       "        -2.84927535e-05, -2.84889307e-05, -2.85135239e-05,\n",
       "        -2.85144457e-05,  1.79299237e-06,  1.80052859e-06,\n",
       "         1.80028961e-06,  1.82399983e-06,  1.82455362e-06,\n",
       "         1.82651308e-06,  1.82748403e-06,  1.80949873e-06,\n",
       "         1.82075527e-06,  1.81703885e-06,  1.81735390e-06,\n",
       "         1.83550718e-06,  1.83787092e-06,  1.80037360e-06,\n",
       "         1.80499907e-06,  1.78775883e-06,  1.78773334e-06,\n",
       "         1.73380860e-06,  1.73202232e-06,  1.82046307e-06,\n",
       "         1.82121234e-06,  1.83001457e-06,  1.83286835e-06,\n",
       "         4.65482495e-06,  4.66131644e-06,  4.76387396e-06,\n",
       "         4.80255624e-06,  4.71197869e-06,  4.72277888e-06,\n",
       "         4.67620379e-06,  4.69681131e-06,  4.70555491e-06,\n",
       "         4.80295387e-06,  4.83478629e-06,  4.69319535e-06,\n",
       "         4.70773232e-06,  4.61525048e-06,  4.61465602e-06,\n",
       "         4.69434284e-06,  4.71494804e-06,  4.72680086e-06,\n",
       "        -2.35462466e-06, -2.34448653e-06, -2.33516983e-06,\n",
       "        -2.31469797e-06, -2.32539947e-06, -2.32102210e-06,\n",
       "        -2.33050945e-06, -2.32642594e-06, -2.33082740e-06,\n",
       "        -2.31125236e-06, -2.33245810e-06, -2.32843801e-06,\n",
       "        -2.35189712e-06, -2.34368340e-06, -2.33128801e-06,\n",
       "        -2.36016111e-06, -2.41405567e-06, -2.41625712e-06,\n",
       "        -2.32858473e-06, -2.32432349e-06, -2.31859432e-06,\n",
       "        -2.30899966e-06,  9.14999471e-08,  9.83707764e-08,\n",
       "         1.67367845e-07,  1.96754667e-07,  1.34156887e-07,\n",
       "         1.30980425e-07,  1.37122709e-07,  1.15653277e-07,\n",
       "         1.32164649e-07,  1.19766449e-07,  1.25900217e-07,\n",
       "         1.90932771e-07,  2.12942835e-07,  9.86486493e-08,\n",
       "         8.78255636e-08,  3.40114502e-08,  3.18815644e-08,\n",
       "         1.27072767e-07,  1.30635224e-07,  1.30131213e-07,\n",
       "        -1.12110179e-07, -1.35090477e-07, -1.01750694e-07,\n",
       "        -3.36290994e-08, -4.07319440e-08, -1.08284272e-08,\n",
       "        -1.36847447e-07, -1.46817947e-07, -1.45648731e-07,\n",
       "        -4.91381546e-08, -5.49438224e-08, -5.27293780e-08,\n",
       "        -4.32723340e-08, -3.43326993e-08, -3.34498204e-08,\n",
       "        -3.38975419e-08, -3.39615457e-08, -3.30999394e-08,\n",
       "        -3.38228610e-08, -3.14067688e-08, -2.87628274e-08,\n",
       "        -3.01632865e-08, -4.14446476e-08, -4.15495701e-08,\n",
       "        -4.14366574e-08, -4.23353360e-08, -4.19521832e-08,\n",
       "        -4.21248349e-08, -8.13686333e-09, -7.79587981e-09,\n",
       "        -7.17483483e-09, -2.97855808e-06,  9.17869467e-06,\n",
       "         7.16376316e-06,  3.16302961e-06,  7.93818708e-06,\n",
       "         8.85707331e-06, -6.27580854e-06, -2.52778033e-07,\n",
       "        -2.41216862e-06,  8.32495001e-08,  1.60846113e-06,\n",
       "         7.71483798e-07, -1.81419896e-05, -1.81231258e-05,\n",
       "        -1.81071350e-05, -1.81418682e-05, -1.81409940e-05,\n",
       "        -1.83046706e-05, -1.81358796e-05, -1.81584523e-05,\n",
       "        -1.81230725e-05, -1.81145587e-05, -1.81310171e-05,\n",
       "        -1.81239934e-05, -1.86465785e-05, -1.81573549e-05,\n",
       "        -1.81749776e-05, -1.81370820e-05, -1.81344782e-05,\n",
       "        -1.81296032e-05, -1.81227627e-05, -1.81270140e-05,\n",
       "        -1.81191233e-05, -2.60704570e-05, -1.52793831e-06,\n",
       "        -1.78015132e-05, -1.76255897e-05, -1.77170348e-05,\n",
       "        -3.53109562e-05, -4.19551791e-05, -1.60652025e-05,\n",
       "         1.58629419e-05,  1.58335938e-05,  1.63062875e-05,\n",
       "         1.64803656e-05,  1.65215767e-05,  1.58518710e-05,\n",
       "         1.58528993e-05,  1.62859887e-05,  1.62860074e-05,\n",
       "         1.59987985e-05,  1.58410268e-05,  1.58004494e-05,\n",
       "         1.58262531e-05,  1.62986538e-05,  1.58768072e-05,\n",
       "         1.58697381e-05,  1.58729034e-05,  1.63096708e-05,\n",
       "         1.63158971e-05,  1.59510241e-05,  1.59857048e-05,\n",
       "         1.63832579e-05,  1.63994920e-05,  1.59968147e-05,\n",
       "         1.58951599e-05,  1.59030822e-05,  1.58971710e-05,\n",
       "         1.63235746e-05,  1.63278931e-05,  1.58982850e-05,\n",
       "         1.63269704e-05,  1.63344482e-05,  1.60296824e-05,\n",
       "         1.64582123e-05,  1.64829041e-05,  7.87779852e-06,\n",
       "        -2.47157210e-06,  2.75488148e-06,  1.52251213e-05,\n",
       "         1.55894230e-05,  1.29763367e-05,  1.67432706e-05,\n",
       "         1.57765710e-05,  1.67106985e-05,  6.16247830e-06,\n",
       "        -2.67495775e-06,  3.36605873e-06,  1.82342743e-05,\n",
       "         1.90852124e-05,  1.83713631e-05,  1.21288734e-05,\n",
       "         1.22098333e-05,  1.21713223e-05,  1.44445831e-05,\n",
       "         1.45784233e-05,  1.46258979e-05,  1.19639974e-05,\n",
       "         1.19670941e-05,  1.19678810e-05,  1.19701702e-05,\n",
       "         1.44299643e-05,  1.21201058e-05,  1.21945336e-05,\n",
       "         1.21598816e-05,  1.20984337e-05,  1.21685647e-05,\n",
       "         1.21340448e-05,  1.44162262e-05,  1.19906603e-05,\n",
       "         1.19984970e-05,  1.19934302e-05,  1.44432475e-05,\n",
       "         1.44517691e-05,  1.19848467e-05,  1.19848209e-05,\n",
       "         1.20694468e-05,  1.20896310e-05,  1.20749622e-05,\n",
       "         1.44981680e-05,  1.21191995e-05,  1.20030608e-05,\n",
       "         1.20105873e-05,  1.20068738e-05,  1.44424524e-05,\n",
       "         1.44464450e-05,  1.20072463e-05,  1.20126845e-05,\n",
       "         1.20108952e-05,  1.44485851e-05,  1.44557126e-05,\n",
       "         1.21605693e-05,  1.21955305e-05,  1.45559888e-05,\n",
       "         1.20006157e-05,  1.20323669e-05,  1.20169599e-05,\n",
       "         2.02744228e-05,  2.15120618e-05,  2.18508355e-05,\n",
       "         1.17101268e-05,  1.04844247e-05,  1.15325014e-05,\n",
       "         1.16115229e-05,  1.50018335e-05,  1.53438336e-05,\n",
       "         1.52530756e-05,  1.77810489e-05,  1.95258682e-05,\n",
       "         1.91171749e-05,  1.47802510e-05,  1.58226941e-05,\n",
       "         1.52550267e-05, -6.14925588e-08,  6.13032513e-08,\n",
       "         3.09373104e-08,  1.04724589e-07,  2.49150510e-07,\n",
       "         1.00495071e-08,  2.28490650e-08, -1.41920508e-08,\n",
       "         4.88418648e-08,  3.06632273e-09,  2.49503994e-08,\n",
       "         2.80025986e-08,  2.89372809e-07,  9.59990616e-08,\n",
       "        -9.23729132e-08,  2.18441578e-07, -1.05907371e-08,\n",
       "        -2.33572446e-09, -1.20987649e-08,  2.97818999e-09,\n",
       "        -9.87863252e-09, -2.48418122e-08, -1.94926040e-08,\n",
       "         1.60820004e-08,  2.70420316e-08,  2.07934509e-08,\n",
       "        -6.16169063e-09,  3.76029328e-06,  5.58298383e-05,\n",
       "         3.02212474e-05,  4.87309363e-06,  1.47950514e-05,\n",
       "         4.90052598e-07,  1.35953568e-05,  8.26712588e-06,\n",
       "         1.42622847e-05,  1.13190915e-05, -1.35016713e-06,\n",
       "         3.60004272e-05,  1.48761106e-05,  2.82149042e-07,\n",
       "         5.20477324e-06,  1.90511385e-06, -1.82346463e-05,\n",
       "        -1.83997020e-05, -1.83067591e-05, -1.80720947e-05,\n",
       "        -1.80824158e-05, -1.80740898e-05, -1.80756784e-05,\n",
       "        -1.81009203e-05, -1.80876111e-05, -3.67884554e-05,\n",
       "        -5.22689503e-05, -4.36558589e-05, -1.81712135e-05,\n",
       "        -1.86077840e-05, -1.82790857e-05, -1.89194876e-05,\n",
       "        -2.11880813e-05, -2.00771606e-05]])"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lr.coef_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.metrics import confusion_matrix, classification_report\n",
    "import seaborn as sns\n",
    "cm = confusion_matrix(Y_val, clf.predict(X_val))\n",
    "sns.heatmap(cm, annot=True, fmt='.0f')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.98      1.00      0.99    113866\n",
      "           1       0.94      0.43      0.59      4242\n",
      "\n",
      "    accuracy                           0.98    118108\n",
      "   macro avg       0.96      0.72      0.79    118108\n",
      "weighted avg       0.98      0.98      0.97    118108\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(Y_val, clf.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "#SMOTE sampling\n",
    "X_smote, y_smote = SMOTE().fit_sample(X_train, Y_train)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 2min 49s, sys: 13.1 s, total: 3min 2s\n",
      "Wall time: 1min\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,\n",
       "                   intercept_scaling=1, l1_ratio=None, max_iter=100,\n",
       "                   multi_class='auto', n_jobs=None, penalty='l2',\n",
       "                   random_state=None, solver='lbfgs', tol=0.0001, verbose=0,\n",
       "                   warm_start=False)"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time lr.fit(X_smote, y_smote)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ACC Score: 0.7759423578419752\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.98      0.78      0.87    113866\n",
      "           1       0.09      0.58      0.16      4242\n",
      "\n",
      "    accuracy                           0.78    118108\n",
      "   macro avg       0.54      0.68      0.51    118108\n",
      "weighted avg       0.95      0.78      0.85    118108\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\"ACC Score:\",accuracy_score(Y_val, lr.predict(X_val)))\n",
    "cm = confusion_matrix(Y_val, lr.predict(X_val))\n",
    "sns.heatmap(cm, annot=True, fmt='.0f')\n",
    "plt.show()\n",
    "print(classification_report(Y_val, lr.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[15:37:07] WARNING: /Users/runner/miniforge3/conda-bld/xgboost_1598185652448/work/src/learner.cc:516: \n",
      "Parameters: { n_esitmators } might not be used.\n",
      "\n",
      "  This may not be accurate due to some parameters are only used in language bindings but\n",
      "  passed down to XGBoost core.  Or some parameters are not used but slip through this\n",
      "  verification. Please open an issue if you find above cases.\n",
      "\n",
      "\n",
      "CPU times: user 6min 20s, sys: 29.3 s, total: 6min 49s\n",
      "Wall time: 1min 30s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,\n",
       "              colsample_bynode=1, colsample_bytree=0.9, gamma=0, gpu_id=-1,\n",
       "              importance_type='gain', interaction_constraints='',\n",
       "              learning_rate=0.05, max_delta_step=0, max_depth=9,\n",
       "              min_child_weight=1, missing=-999, monotone_constraints='()',\n",
       "              n_esitmators=500, n_estimators=100, n_jobs=0, num_parallel_tree=1,\n",
       "              objective='binary:logistic', random_state=2019, reg_alpha=0,\n",
       "              reg_lambda=1, scale_pos_weight=1, subsample=0.9,\n",
       "              tree_method='hist', validate_parameters=1, verbosity=None)"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time clf.fit(X_smote, y_smote)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ACC Score: 0.9730585565753378\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.98      1.00      0.99    113866\n",
      "           1       0.74      0.38      0.51      4242\n",
      "\n",
      "    accuracy                           0.97    118108\n",
      "   macro avg       0.86      0.69      0.75    118108\n",
      "weighted avg       0.97      0.97      0.97    118108\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(\"ACC Score:\",accuracy_score(Y_val, clf.predict(X_val)))\n",
    "cm = confusion_matrix(Y_val, clf.predict(X_val))\n",
    "sns.heatmap(cm, annot=True, fmt='.0f')\n",
    "plt.show()\n",
    "print(classification_report(Y_val, clf.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import confusion_matrix, classification_report\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "cm = confusion_matrix(Y_val, clf.predict_proba(X_val)[:,1].round())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.heatmap(cm, annot=True, fmt='.0f')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.97      0.99      0.98    113934\n",
      "           1       0.99      0.97      0.98    114017\n",
      "\n",
      "    accuracy                           0.98    227951\n",
      "   macro avg       0.98      0.98      0.98    227951\n",
      "weighted avg       0.98      0.98      0.98    227951\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(Y_val, clf.predict_proba(X_val)[:,1].round()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import roc_auc_score,precision_recall_curve,roc_curve\n",
    "def plot_pre_curve(y_test,probs):\n",
    "    precision, recall, thresholds = precision_recall_curve(y_test, probs)\n",
    "    plt.plot([0, 1], [0.5, 0.5], linestyle='--')\n",
    "    # plot the precision-recall curve for the model\n",
    "    plt.plot(recall, precision, marker='.')\n",
    "    plt.title(\"precision recall curve\")\n",
    "    plt.xlabel('Recall')\n",
    "    plt.ylabel('Precision')\n",
    "    # show the plot\n",
    "    plt.show()\n",
    "    \n",
    "def plot_roc(y_test,probs):\n",
    "    fpr, tpr, thresholds = roc_curve(y_test, probs)\n",
    "    # plot no skill\n",
    "    plt.plot([0, 1], [0, 1], linestyle='--')\n",
    "    # plot the roc curve for the model\n",
    "    plt.plot(fpr, tpr, marker='.')\n",
    "    plt.title(\"ROC curve\")\n",
    "    plt.xlabel('false positive rate')\n",
    "    plt.ylabel('true positive rate')\n",
    "    # show the plot\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYIAAAEWCAYAAABrDZDcAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAZsklEQVR4nO3df5xVdZ3H8dc7kPAnpoylMIIZVmRqOpE+3C3LMnRT2moN0wpLSUvNfrhp2ypR1tbWtpuya7iSZioaW+3YsumKlmWiDIEYGDWSyIjliIqpKIKf/eOcscudOzN3mDn3zp3v+/l4zIN7zvnecz7fucN93/M995yjiMDMzNL1knoXYGZm9eUgMDNLnIPAzCxxDgIzs8Q5CMzMEucgMDNLnIPAGpKkkyXdXEW7yyT9Yy1qKoKkiZJC0sh8+meSTqt3XTa8jKx3AWbbIyKuAa6pot0ZNSjHrKF5j8DqputT7nDgvlgjcxDYoJL0gKQLJK2S9Lik70oanS87SlKHpM9J+iPw3Xz+uyQtl/SEpF9JOqhkfc2SfiipU9IGSZfm82dI+mX+WJK+JekRSRslrZB0YL7sSklfLlnf6ZLaJT0mqVXSPiXLQtIZkn6f1z5Hknro5yxJCyR9X9KTwAxJL5F0vqT781pvkLRHyXP+Ku/fE5LWSZqRz/8bScskPZnPn7Wdv/sRkj6fb//Pkpbmv79thpfyti8OMeW/yzvy3+FjwJfyGg8sad8kaZOkvfp6zazxOAisCCcD7wT2Bw4AvlCy7BXAHsAEYKakQ4F5wMeAPYHvAK2SXippBPATYC0wERgHzK+wvWOAN+fb2h14P7ChvJGktwFfBU4E9s7XW76+dwFvBA7O272zl35OAxbk27wGOAd4N/AWYB/gcWBOvu19gf8FLgGagEOA5fl6ngY+lK/nb4AzJb27l+325NPAScBxwG7AR4Bnqnzum4A1wF7AbOCH+bq6nAj8PCIe6e01246abQhwEFgRLo2IdRHxGHAx276hvABcFBHPRcQm4HTgOxFxV0RsjYirgOeAw4EpZG+o50XE0xHxbET8ssL2ngd2BV4DKCLui4iHK7Q7GZgXEb+OiOeAC4AjJE0safNPEfFERDwI3Eb2ht2TOyPixxHxQt6XjwH/EBEd+fpnAe/LP4mfDNwSEddFxPMRsSEilgNExM8i4t58PSuA68jCpL9OA74QEasjc09EdAvEHqyPiEsiYkvel2vZ9nX7QD4Pen/NrAE5CKwI60oeryV7M+/SGRHPlkxPAD6TDzE8IekJoDl/TjOwNiK29LaxiLgVuJTs0/efJM2VtFuFpvvk9XQ97ymyPYdxJW3+WPL4GWCXXja9rmx6AvCjkn7cB2wFXp735f5KK5H0Jkm35cNfG4EzgLG9bLcnPW6jCuV9uRXYMa9tAlkg/ihf1ttrZg3IQWBFaC55vC+wvmS6/HK364CLI2L3kp+dIuK6fNm+1Ry8jIhvR8RhwOvIhojOq9BsPdmbGACSdiYb2niomk5V2myFvhxb1pfREfFQvmz/HtZzLdAKNEfEGOAyoOKxiT70tI2n8393Kpn3irI22/QlIl4AbiDbK/gA8JOI+HPJdnp6zawBOQisCJ+QND4/UPp54Ppe2l4OnJF/8pSknfODp7sCdwMPA/+Uzx8t6cjyFUh6Y/78Hcje9J4l+yRe7lrgVEmH5OPZXwHuiogHBtTbv7gMuDj/BN11gHVavuwa4O2STpQ0UtKekrqGnXYFHouIZyVNIXvj3R7/SXagd1L+uzxI0p4R0UkWdqfkB5Q/Qs+hVOpasuMtJ/OXYSHo/TWzBuQgsCJcC9xMdvBxDfDlnhpGRBvZmPOlZAdX24EZ+bKtwPHAq4AHgQ6yN6Zyu5G9OT1ONvSzAfhGhW0tAv4R+C+ygNkfmN7/7vXo38g+2d8s6c/AYrKDsOTHHI4DPgM8Rnag+OD8eR8HZufPuZDsk/j2+Jf8uTcDTwJXADvmy04n20vaQLbX9Ku+VhYRd5EF6z5kB7q75vf4mlljkm9MY4NJ0gPAaRFxS71rMbPqeI/AzCxxDgIzs8R5aMjMLHHeIzAzS1zDXVxq7NixMXHixHqXYWbWUJYuXfpoRDRVWtZwQTBx4kTa2trqXYaZWUORtLanZR4aMjNLnIPAzCxxDgIzs8Q5CMzMEucgMDNLXGFBIGmeslsH/qaH5ZL0bWW3DVyR3/XIzMxqrMivj15JdnXC7/Ww/FhgUv7zJuA/8n+LMWtMYas2s8TN2ljvCgaksCCIiNvLbgFYbhrwvciucbFY0u6S9u7hFoMD4xAwsyIN5D1m1K7w+Y7Bq2U71PMYwTi2vT1eB9veMvBFkmZKapPU1tnZWZPizMxqYvOf6/5htZ5BUOlWfBWvgBcRcyOiJSJampoqniFtZtbY6hgG9QyCDra9t+14tr237eBp8PE7M0tEncKgntcaagXOkjSf7CDxxkKOD3RxGJjZYCrqTXvWmJq/XxUWBJKuA44CxkrqAC4CdgCIiMuAhWT3cG0HngFOLaoWM7NBN9A36yH0JZaGuzFNS0tL+OqjZjYs9BYGg7xXIGlpRLRUWuYzi83M6mWIDFk7CMzMEucgMDOrpyGwV+AgMDMbimp4MNlBYGaWOAeBmVniHARmZvVW5+MEDgIzs8Q5CMzMhqoaHTB2EJiZJc5BYGaWOAeBmdlQUMcDxg4CM7PEOQjMzBLnIDAzS5yDwMwscQ4CM7OhrAbnEjgIzMwS5yAwM0ucg8DMbKio07kEDgIzs8Q5CMzMEucgMDNLnIPAzCxxDgIzs8Q5CMzMEucgMDNLnIPAzCxxDgIzs6Gu4OsNOQjMzBLnIDAzS1yhQSBpqqTVktolnV9h+QRJiyStkPQzSeOLrMfMbMirw/WGCgsCSSOAOcCxwGTgJEmTy5p9A/heRBwEzAa+WlQ9ZmZWWZF7BFOA9ohYExGbgfnAtLI2k4FF+ePbKiw3M7OCFRkE44B1JdMd+bxS9wDvzR//LbCrpD3LVyRppqQ2SW2dnZ2FFGtmlqoig0AV5kXZ9GeBt0haBrwFeAjY0u1JEXMjoiUiWpqamga/UjOzhI0scN0dQHPJ9HhgfWmDiFgPvAdA0i7AeyOiPndmMDNLVJF7BEuASZL2kzQKmA60ljaQNFZSVw0XAPMKrMfMzCooLAgiYgtwFnATcB9wQ0SslDRb0gl5s6OA1ZJ+B7wcuLioeszMrLIih4aIiIXAwrJ5F5Y8XgAsKLIGMzPrnc8sNjNLnIPAzCxxDgIzs8Q5CMzMEucgMDNrBAXek8BBYGaWOAeBmVniHARmZkNNje9J4CAwM0ucg8DMLHEOAjOzxDkIzMwS5yAwM0ucg8DMLHEOAjOzxDkIzMwS5yAwM0ucg8DMLHEOAjOzxDkIzMwS5yAwM0ucg8DMLHEOAjOzxDkIzMwS5yAwM0ucg8DMLHEOAjOzxDkIzMwS5yAwM0ucg8DMLHGFBoGkqZJWS2qXdH6F5ftKuk3SMkkrJB1XZD1mZtZdYUEgaQQwBzgWmAycJGlyWbMvADdExBuA6cC/F1WPmVnDmzWmkNUWuUcwBWiPiDURsRmYD0wraxPAbvnjMcD6AusxM7MKRlbbUNI4YELpcyLi9l6eMg5YVzLdAbyprM0s4GZJZwM7A2/vYdszgZkA++67b7Ulm5lZFaraI5D0NeAOsqGc8/Kfz/b1tArzomz6JODKiBgPHAdcLalbTRExNyJaIqKlqampmpLNzBrbrI0121S1ewTvBl4dEc/1Y90dQHPJ9Hi6D/18FJgKEBF3ShoNjAUe6cd2zMxsAKo9RrAG2KGf614CTJK0n6RRZAeDW8vaPAgcDSDptcBooLOf2zEzswGodo/gGWC5pEXAi3sFEXFOT0+IiC2SzgJuAkYA8yJipaTZQFtEtAKfAS6X9CmyYaMZEVE+fGRmZgWqNgha6f5pvk8RsRBYWDbvwpLHq4Aj+7teMzMbPFUFQURclQ/vHJDPWh0RzxdXlpmZ1UpVQSDpKOAq4AGybwM1S/pwH18fNTOzBlDt0NA3gWMiYjWApAOA64DDiirMzMxqo9pvDe3QFQIAEfE7+v8tIjMzG4Kq3SNok3QFcHU+fTKwtJiSzMyslqoNgjOBTwDnkB0juB1fIM7MbFio9ltDzwH/kv+Ymdkw0msQSLohIk6UdC/drxNERBxUWGVmZlYTfe0RfDL/911FF2JmZvXR67eGIuLh/OGjwLqIWAu8FDgY3zvAzGxYqPbro7cDo/N7EiwCTgWuLKooMzOrnWqDQBHxDPAe4JKI+Fuy20+amVmDqzoIJB1Bdv7A/+Tzqr67mZmZDV3VBsG5wAXAj/JLSb8SuK24sszMrFaqPY/g58DPS6bXkJ1cZmZmDa6v8wj+NSLOlXQjlc8jOKGwyszMrCb62iPourbQN4ouxMzM6qPXIIiIrgvLtQGbIuIFAEkjyM4nMDOzBlftweJFwE4l0zsCtwx+OWZmVmvVBsHoiHiqayJ/vFMv7c3MrEFUGwRPSzq0a0LSYcCmYkoyM7NaqvaksHOBH0jqur7Q3sD7iynJzMxqqdrzCJZIeg3warIb0/w2Ip4vtDIzM6uJqoaGJO0EfA74ZETcC0yU5EtTm5kNA9UeI/gusBk4Ip/uAL5cSEVmZlZT1QbB/hHxdeB5gIjYRDZEZGZmDa7aINgsaUfyy0xI2h94rrCqzMysZqr91tBFwE+BZknXAEcCM4oqyszMaqfPIJAk4LdkN6U5nGxI6JMR8WjBtZmZWQ30GQQREZJ+HBGH8Zeb0piZ2TBR7TGCxZLeWGglZmbWt1ljBn2V1QbBW8nC4H5JKyTdK2lFX0+SNFXSakntks6vsPxbkpbnP7+T9ER/O2BmZgNT7cHiY/u74vxS1XOAd5Cdd7BEUmtErOpqExGfKml/NvCG/m7HzMwGptc9AkmjJZ0LnAdMBR6KiLVdP32sewrQHhFrImIzMB+Y1kv7k4Dr+lG7mdnwNmtjTTbT19DQVUALcC/ZXsE3+7HuccC6kumOfF43kiYA+wG39rB8pqQ2SW2dnZ39KMHMzPrS19DQ5Ih4PYCkK4C7+7HuSmced7vvcW46sCAitlZaGBFzgbkALS0tPa3DzMy2Q197BC9eYTQitvRz3R1Ac8n0eGB9D22n42EhM7O66GuP4GBJT+aPBeyYT4vsFIPdennuEmCSpP2Ah8je7D9Q3kjSq4GXAXf2t3gzMxu4vm5eP2J7VxwRWySdBdwEjADmRcRKSbOBtohozZueBMyPCA/5mJnVQbVfH90uEbEQWFg278Ky6VlF1mBmZr2r9oQyMzMbphwEZmaJcxCYmSXOQWBmljgHgZlZ4hwEZmaJcxCYmSXOQWBmljgHgZlZ4hwEZmaJcxCYmSXOQWBmljgHgZlZ4hwEZmaJcxCYmSXOQWBmljgHgZlZ4hwEZmaJcxCYmSXOQWBmljgHgZlZ4hwEZmaJcxCYmSXOQWBmljgHgZlZ4hwEZmaJcxCYmSXOQWBmljgHgZlZ4hwEZmaJKzQIJE2VtFpSu6Tze2hzoqRVklZKurbIeszMrLuRRa1Y0ghgDvAOoANYIqk1IlaVtJkEXAAcGRGPS9qrqHrMzKyyIvcIpgDtEbEmIjYD84FpZW1OB+ZExOMAEfFIgfWYmVkFRQbBOGBdyXRHPq/UAcABku6QtFjS1EorkjRTUpukts7OzoLKNTNLU5FBoArzomx6JDAJOAo4CfhPSbt3e1LE3IhoiYiWpqamQS/UzCxlRQZBB9BcMj0eWF+hzX9HxPMR8QdgNVkwmJlZjRQZBEuASZL2kzQKmA60lrX5MfBWAEljyYaK1hRYk5mZlSksCCJiC3AWcBNwH3BDRKyUNFvSCXmzm4ANklYBtwHnRcSGomoyM7PuCvv6KEBELAQWls27sORxAJ/Of8zMrA58ZrGZWeIcBGZmiXMQmJklzkFgZpY4B4GZWeIcBGZmiXMQmJklzkFgZpY4B4GZWeIcBGZmiXMQmJklzkFgZpY4B4GZWaOZNWZQV+cgMDNLnIPAzCxxDgIzs6Fs1sbCN+EgMDNLnIPAzCxxDgIzs8Q5CMzMEucgMDNLnIPAzCxxDgIzs8Q5CMzMEucgMDNLnIPAzCxxDgIzs8Q5CMzMEucgMDNLnIPAzCxxDgIzs8QVGgSSpkpaLald0vkVls+Q1Clpef5zWpH1mJlZdyOLWrGkEcAc4B1AB7BEUmtErCpren1EnFVUHWZm1rvCggCYArRHxBoASfOBaUB5ENTM+79zZ7d57zpobz54xEQ2bd7KjO/e3W35+w4bz9+1NPPY05s58/tLuy0/5fAJHH/wPqx/YhOfun55t+Wn//Urefvkl3N/51N8/of3dlt+9tsm8VeTxrJy/UZm39j9V/P3U1/NYRP2YOnax/j6T1d3W37h8ZN53T5j+OXvH+WSW3/fbflX3vN69m/ahVtW/YnLf7Gm2/Jvvf8Q9tl9R268Zz3fX7y22/L/OOUw9th5FD9oW8eCpR3dll956hR2HDWCq+98gJ+seLjb8us/dgQAc2+/n0X3PbLNstE7jOCqj0wB4NuLfs8d7Y9us/xlO43isg8eBsDXfvpbfr328W2W7z1mNP86/Q0AfPHGlaxa/+Q2y1/ZtDNffc9BAFzwwxWs6Xx6m+WT99mNi45/HQDnzl/Gwxuf3Wb5oRNexuemvgaAM65eyuPPbN5m+ZGvGss5R08C4MPz7ubZ57dus/zo1+7FzDfvD/hvz397A/vb+3eKHb4pct3jgHUl0x35vHLvlbRC0gJJzZVWJGmmpDZJbZ2dnUXUamY2ZL0ARIHrV0Qxq5f0d8A7I+K0fPqDwJSIOLukzZ7AUxHxnKQzgBMj4m29rbelpSXa2toKqdnMbEhadzdc8Y6/TH/0/6B5Sr9WIWlpRLRUWlbk0FAHUPoJfzywvrRBRGwombwc+FqB9ZiZNabmKdmb/wO/gIl/3e8Q6EuRQbAEmCRpP+AhYDrwgdIGkvaOiK7BvROA+wqsx8yscTVPGfQA6FJYEETEFklnATcBI4B5EbFS0mygLSJagXMknQBsAR4DZhRVj5mZVVbYMYKi+BiBmVn/9XaMwGcWm5klzkFgZpY4B4GZWeIcBGZmiWu4g8WSOoHu56NXZyzwaJ+thhf3OQ3ucxoG0ucJEdFUaUHDBcFASGrr6aj5cOU+p8F9TkNRffbQkJlZ4hwEZmaJSy0I5ta7gDpwn9PgPqehkD4ndYzAzMy6S22PwMzMyjgIzMwSNyyDQNJUSasltUs6v8Lyl0q6Pl9+l6SJta9ycFXR509LWpXfDW6RpAn1qHMw9dXnknbvkxSSGv6rhtX0WdKJ+Wu9UtK1ta5xsFXxt72vpNskLcv/vo+rR52DRdI8SY9I+k0PyyXp2/nvY4WkQwe80YgYVj9kl7y+H3glMAq4B5hc1ubjwGX54+nA9fWuuwZ9fiuwU/74zBT6nLfbFbgdWAy01LvuGrzOk4BlwMvy6b3qXXcN+jwXODN/PBl4oN51D7DPbwYOBX7Tw/LjgP8FBBwO3DXQbQ7HPYIpQHtErImIzcB8YFpZm2nAVfnjBcDRklTDGgdbn32OiNsi4pl8cjHZHeMaWTWvM8CXgK8Dz1ZY1miq6fPpwJyIeBwgIh6hsVXT5wB2yx+PoexOiI0mIm4nuz9LT6YB34vMYmB3SXsPZJvDMQjGAetKpjvyeRXbRMQWYCOwZ02qK0Y1fS71UbJPFI2szz5LegPQHBE/qWVhBarmdT4AOEDSHZIWS5pas+qKUU2fZwGnSOoAFgJnM7z19/97n4q8VWW9VPpkX/4d2WraNJKq+yPpFKAFeEuhFRWv1z5LegnwLYbXXe+qeZ1Hkg0PHUW21/cLSQdGxBMF11aUavp8EnBlRHxT0hHA1XmfXyi+vLoY9Pev4bhH0AE0l0yPp/uu4ottJI0k253sbVdsqKumz0h6O/APwAkR8VyNaitKX33eFTgQ+JmkB8jGUlsb/IBxtX/b/x0Rz0fEH4DVZMHQqKrp80eBGwAi4k5gNNnF2Yarqv6/98dwDIIlwCRJ+0kaRXYwuLWsTSvw4fzx+4BbIz8K06D67HM+TPIdshBo9HFj6KPPEbExIsZGxMSImEh2XOSEiGjk+5xW87f9Y7IvBiBpLNlQ0ZqaVjm4qunzg8DRAJJeSxYEnTWtsrZagQ/l3x46HNgYEQ8PZIXDbmgoIrZIOgu4iewbB/MiYqWk2UBbRLQCV5DtPraT7QlMr1/FA1dln/8Z2AX4QX5c/MGIOKFuRQ9QlX0eVqrs803AMZJWAVuB8yJiQ/2qHpgq+/wZ4HJJnyIbIpnRyB/sJF1HNrQ3Nj/ucRGwA0BEXEZ2HOQ4oB14Bjh1wNts4N+XmZkNguE4NGRmZv3gIDAzS5yDwMwscQ4CM7PEOQjMzBLnIDArI2mrpOWSfiPpRkm7D/L6Z0i6NH88S9JnB3P9Zv3lIDDrblNEHBIRB5KdZ/KJehdkViQHgVnv7qTkgl6SzpO0JL8O/BdL5n8on3ePpKvzecfn97tYJukWSS+vQ/1mfRp2ZxabDRZJI8guXXBFPn0M2XV7ppBd+KtV0puBDWTXcDoyIh6VtEe+il8Ch0dESDoN+Huys2DNhhQHgVl3O0paDkwElgL/l88/Jv9Zlk/vQhYMBwMLIuJRgIjouoDheOD6/Frxo4A/1KR6s37y0JBZd5si4hBgAtkbeNcxAgFfzY8fHBIRr4qIK/L5la7VcglwaUS8HvgY2cXQzIYcB4FZDyJiI3AO8FlJO5Bd+OwjknYBkDRO0l7AIuBESXvm87uGhsYAD+WPP4zZEOWhIbNeRMQySfcA0yPi6vwyx3fmV3B9CjglvxrmxcDPJW0lGzqaQXbnrB9IeojsMtj71aMPZn3x1UfNzBLnoSEzs8Q5CMzMEucgMDNLnIPAzCxxDgIzs8Q5CMzMEucgMDNL3P8DPF0TqIXhMMcAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plot_pre_curve(Y_val, clf.predict_proba(X_val)[:,1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plot_roc(Y_val, clf.predict_proba(X_val)[:,1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 4min 15s, sys: 11.7 s, total: 4min 27s\n",
      "Wall time: 4min 35s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',\n",
       "                       max_depth=None, max_features=None, max_leaf_nodes=None,\n",
       "                       min_impurity_decrease=0.0, min_impurity_split=None,\n",
       "                       min_samples_leaf=1, min_samples_split=2,\n",
       "                       min_weight_fraction_leaf=0.0, presort='deprecated',\n",
       "                       random_state=None, splitter='best')"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Dicision tree model\n",
    "model = DecisionTreeClassifier()\n",
    "%time model.fit(X_smote, y_smote)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Square root of error squares 0.14850247496709626\n",
      "Roc Auc Score: 0.9779462021576555\n"
     ]
    }
   ],
   "source": [
    "print(\"Square root of error squares\", np.sqrt(mean_squared_error(Y_val, model.predict_proba(X_val)[:,1])))\n",
    "print(\"Roc Auc Score:\",roc_auc_score(Y_val, model.predict_proba(X_val)[:,1]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": [
    "cm_tree = confusion_matrix(Y_val, model.predict(X_val))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.heatmap(cm_tree, annot=True, fmt='.0f')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.98      0.98      0.98    113934\n",
      "           1       0.98      0.98      0.98    114017\n",
      "\n",
      "    accuracy                           0.98    227951\n",
      "   macro avg       0.98      0.98      0.98    227951\n",
      "weighted avg       0.98      0.98      0.98    227951\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(Y_val, model.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plot_pre_curve(Y_val, clf.predict(X_val))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor\n",
    "#Hyper param tuned\n",
    "rf_tuned = RandomForestRegressor(max_depth=45, max_features=45, n_estimators=500, n_jobs=-1, min_samples_leaf=100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 1h 34min 59s, sys: 17.3 s, total: 1h 35min 16s\n",
      "Wall time: 12min 35s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "RandomForestRegressor(bootstrap=True, ccp_alpha=0.0, criterion='mse',\n",
       "                      max_depth=45, max_features=45, max_leaf_nodes=None,\n",
       "                      max_samples=None, min_impurity_decrease=0.0,\n",
       "                      min_impurity_split=None, min_samples_leaf=100,\n",
       "                      min_samples_split=2, min_weight_fraction_leaf=0.0,\n",
       "                      n_estimators=500, n_jobs=-1, oob_score=False,\n",
       "                      random_state=None, verbose=0, warm_start=False)"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time rf_tuned.fit(X_train, Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 3h 13min 4s, sys: 38.6 s, total: 3h 13min 42s\n",
      "Wall time: 25min 43s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "RandomForestRegressor(bootstrap=True, ccp_alpha=0.0, criterion='mse',\n",
       "                      max_depth=45, max_features=45, max_leaf_nodes=None,\n",
       "                      max_samples=None, min_impurity_decrease=0.0,\n",
       "                      min_impurity_split=None, min_samples_leaf=100,\n",
       "                      min_samples_split=2, min_weight_fraction_leaf=0.0,\n",
       "                      n_estimators=500, n_jobs=-1, oob_score=False,\n",
       "                      random_state=None, verbose=0, warm_start=False)"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time rf_tuned.fit(X_smote, y_smote)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Square root of error squares 0.14885177286073234\n",
      "Roc Auc Score: 0.9952690963268704\n"
     ]
    }
   ],
   "source": [
    "print(\"Square root of error squares\", np.sqrt(mean_squared_error(Y_val, rf_tuned.predict(X_val))))\n",
    "print(\"Roc Auc Score:\",roc_auc_score(Y_val, rf_tuned.predict(X_val)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fitting 10 folds for each of 500 candidates, totalling 5000 fits\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.\n"
     ]
    }
   ],
   "source": [
    "n_estimators = [100, 300, 500, 800, 1200]\n",
    "max_depth = [25, 30, 35, 40, 45]\n",
    "max_features = [20, 25, 30, 35, 45]\n",
    "min_samples_leaf = [100, 200, 300, 400] \n",
    "\n",
    "hyperF = dict(n_estimators = n_estimators, max_depth = max_depth,  \n",
    "              max_features = max_features, \n",
    "             min_samples_leaf = min_samples_leaf)\n",
    "\n",
    "gridF = GridSearchCV(rf_tuned, hyperF, cv = 10, verbose = 1, \n",
    "                      n_jobs = -1)\n",
    "bestF = gridF.fit(X_train, Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAzwAAAYvCAYAAABFjPp8AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nOzdf5ind13f+9db1qShCFxAKiypxktAKlYiu6Hn9KqAjZxQhSO0AuupYFIk5br0skhrOVquI5c9XpamR7gOntbmlKggLjkJJFATwRZJwQqmM3EJBvUKAZWw1ISQqLFqwbzPH3NPM2xmd2Z3dpndN4/Hdc2V+X7uH9/PPfPH7jOf+3tvdXcAAAAm+rLdngAAAMCpIngAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkegCGq6ner6k+r6r4NX3t3eM5nVdUdJ2uO23zPn62q//OL+Z5HU1Wvraqf3+15AHDiBA/ALM/r7odt+Dq8m5Opqj27+f47cSbPHYAHCB6ALwFV9T9V1a9V1b1V9eGqetaGbZdW1W9V1R9X1cer6h8u4385yS8l2btxxejIFZgjV4GWlaZXV9UtSf6kqvYsx729qu6qqk9U1Q9sc97nV1Uvc/xkVd1TVa+oqgur6pblen5qw/6XVNV/rqo3VtUfVtVvV9VFG7bvrap3VdVnq+pjVfXyDdteW1XXVNXPV9UfJXlFkh9J8uLl2j98rJ/Xxp9FVf3jqrqzqj5dVZdu2H5OVf1fVfV7y/x+tarO2ep3BMCJ83+vAIarqscnuT7JS5K8O8lFSd5eVU/u7ruS3JnkuUk+nuQZSX6pqv5Ld99cVX8nyc9393kbzredt/2uJN+e5DNJ7k/y75O8cxk/L8l/rKrf6e73bPMy/kaSJy7ze9dyHd+a5MuT/EZVXd3d/2nDvtckeUySv5vkHVX1Nd392SQHk9yaZG+SJyf5D1X18e5+73LsdyR5YZKXJjl7OccTuvu7N8zlqD+vZftjkzwiyeOTPDvJNVV1XXffk+RfJXlKkr+Z5L8uc71/G78jAE6QFR6AWa5bVgjurarrlrHvTnJDd9/Q3fd3939IspLk25Kku6/v7tt7zX9K8stJvnmH8/i/u/uT3f2nSS5Mcm53/1h3//fu/niS/zfJgeM43z/v7j/r7l9O8idJDnb3nd39qSQfSPJNG/a9M8kbuvtz3X1Vkt9J8u1V9VeT/K0kr17OdSjJv8taZKz7YHdft/yc/nSziWzj5/W5JD+2vP8NSe5L8nVV9WVJ/kGSf9Tdn+ruv+juX+vuP88WvyMATpwVHoBZnt/d//GIsa9O8sKqet6GsS9P8r4kWVZxfjTJk7L2P8IemuQjO5zHJ494/71Vde+GsYdkLVS26w82fP+nm7x+2IbXn+ru3vD697K2orM3yWe7+4+P2Lb/KPPe1DZ+Xnd39+c3vP5vy/wek+QvJbl9k9Me83cEwIkTPADzfTLJW7r75UduqKqzk7w9a7dwvbO7P7esDK3ft9ZHHpO1FZaHbnj92E322XjcJ5N8orufeCKTPwGPr6raED1flbXb4A4neVRVfcWG6PmqJJ/acOyR1/sFr7fx8zqWzyT5syRfm+TDR2w76u8IgJ1xSxvAfD+f5HlVdXFVPaSq/tLy4frzkpyVtc+q3JXk88vqxf+y4dg/SPLoqnrEhrFDSb6tqh5VVY9N8sot3v+mJH+0PMjgnGUO31BVF560K/xCfyXJD1TVl1fVC5P8tazdLvbJJL+W5CeWn8E3JnlZkrce41x/kOT85Xa0ZOuf11F19/1Jrkzyk8vDEx5SVf/zElHH+h0BsAOCB2C45S/635G1J47dlbXVhB9K8mXLSscPJPn/ktyT5H/L2mrI+rG/nbUP+n98+VzQ3iRvydoKxe9m7fMrV23x/n+R5HlJLkjyiaytdPy7rH2w/1T49aw94OAzSX48yXd2993Ltu9Kcn7WVnuuTfKjy+dljubq5b93V9XNW/28tuGfZO32t/+S5LNJXpe138NRf0fHcW4ANlFfeJszAJy5quqSJN/b3X9rt+cCwOnB/zkCAADGEjwAAMBYbmkDAADGssIDAACMJXgAAICxTvt/ePQxj3lMn3/++bs9DQAA4DS1urr6me4+d7Ntp33wnH/++VlZWdntaQAAAKepqvq9o21zSxsAADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMbas9sT2MrqalK127MAAACSpHu3Z3B8rPAAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWMcMnqq6saouPmLslVV1Q1V9sKpurapbqurFG7b/bFV9oqoOLV8XLOOPqKp/X1UfXo679NRcEgAAwJo9W2w/mORAkvdsGDuQ5NVJDnf3bVW1N8lqVb2nu+9d9vmh7r7miHN9X5KPdvfzqurcJL9TVW/t7v9+Eq4DAADgQba6pe2aJM+tqrOTpKrOT7I3yfu7+7Yk6e7DSe5Mcu4W5+okX1FVleRhST6b5PMnPHMAAIAtHDN4uvvuJDclec4ydCDJVd3d6/tU1dOTnJXk9g2H/vhyq9vr12MpyU8l+WtJDif5SJJ/1N33n5zLAAAAeLDtPLRg/ba2LP89uL6hqh6X5C1JLt0QLz+c5MlJLkzyqKzd/pYkFyc5lLUVoguS/FRVPXyzN6yqy6pqpapWkruO74oAAAAW2wme65JcVFVPS3JOd9+cJEusXJ/kNd39ofWdu/vTvebPk/xMkqcvmy5N8o5l28eSfCJrYfQg3X1Fd+/v7v1b3ykHAACwuS2Dp7vvS3JjkiuzrO5U1VlJrk3y5u6+euP+y6pPls/qPD/Jby6bfj/JRcu2r0zydUk+fjIuAgAAYDNbPaVt3cEk78gDt7a9KMkzkjy6qi5Zxi7p7kNJ3ro8ha2ydgvbK5bt/zzJz1bVR5Ztr+7uz+z8EgAAADZXG54/cFqq2t/Jym5PAwAASHI65kNVra59HObBtvMZHgAAgDOS4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMtWe3J7CVffuSlZXdngUAAHAmssIDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAY+3Z7QlsZXU1qdrtWQAAwJmve7dn8MVnhQcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGOmbwVNWNVXXxEWOvrKobquqDVXVrVd1SVS/esP1nq+oTVXVo+bpgGf+hDWO/WVV/UVWPOjWXBQAAkOzZYvvBJAeSvGfD2IEkr05yuLtvq6q9SVar6j3dfe+yzw919zUbT9Tdlye5PEmq6nlJfrC7P3syLgIAAGAzW93Sdk2S51bV2UlSVecn2Zvk/d19W5J09+EkdyY59zje97uyFlMAAACnzDGDp7vvTnJTkucsQweSXNXdvb5PVT09yVlJbt9w6I8vt7q9fj2WNuz/0OV8bz8J8wcAADiq7Ty0YP22tiz//R8rM1X1uCRvSXJpd9+/DP9wkicnuTDJo7J2+9tGz0vyn491O1tVXVZVK1W1kty1rQsBAAA40naC57okF1XV05Kc0903J0lVPTzJ9Ule090fWt+5uz/da/48yc8kefoR5/uCaNpMd1/R3fu7e//x3SkHAADwgC2Dp7vvS3JjkiuzhEpVnZXk2iRv7u6rN+6/rPqkqirJ85P85oZtj0jyzCTvPDnTBwAAOLqtntK27mCSd+SBW9telOQZSR5dVZcsY5d096Ekb62qc5NUkkNJXrHhPC9I8svd/Sc7nTgAAMBWasPzB05LVfs7WdntaQAAwBnvNP+r/wmrqtW1j8M82HY+wwMAAHBGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsfbs9gS2sm9fsrKy27MAAADORFZ4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYKw9uz2BrayuJlW7PQsAADhzdO/2DE4fVngAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgrGMGT1XdWFUXHzH2yqq6oao+WFW3VtUtVfXiDdu/pqp+vapuq6qrquqsZfwZVXVzVX2+qr7z1FwOAADAA7Za4TmY5MARYweSvC7JS7v7KUmek+QNVfXIZfvrkry+u5+Y5J4kL1vGfz/JJUl+4STMGwAAYEtbBc81SZ5bVWcnSVWdn2Rvkvd3921J0t2Hk9yZ5NyqqiR/ezkuSX4uyfOX/X63u29Jcv9JvgYAAIBNHTN4uvvuJDdlbRUnWVvduaq7e32fqnp6krOS3J7k0Unu7e7PL5vvSPL4kz1pAACA7djOQws23tZ2YHmdJKmqxyV5S5JLu/v+JLXJ8b3J2DFV1WVVtVJVK8ldx3s4AABAku0Fz3VJLqqqpyU5p7tvTpKqeniS65O8prs/tOz7mSSPrKo9y+vzkhw+3kl19xXdvb+79yfnHu/hAAAASbYRPN19X5Ibk1yZZXVnefLatUne3N1Xb9i3k7wvyfpT2L4nyTtP7pQBAAC2Z7v/Ds/BJE9N8rbl9YuSPCPJJVV1aPm6YNn26iSvqqqPZe0zPW9Kkqq6sKruSPLCJP+2qm49WRcBAACwmdrw/IHTUtX+TlZ2exoAAHDGOM3/in/SVdXq2sdhHmy7KzwAAABnHMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGGvPbk9gK/v2JSsruz0LAADgTGSFBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMbas9sT2MrqalK127MAAOBEde/2DPhSZoUHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWFsGT1XdWFUXHzH2yqq6oao+WFW3VtUtVfXiDdu/pqp+vapuq6qrquqsZfzs5fXHlu3nn+wLAgAAWLedFZ6DSQ4cMXYgyeuSvLS7n5LkOUneUFWPXLa/Lsnru/uJSe5J8rJl/GVJ7unuJyR5/bIfAADAKbGd4LkmyXOr6uwkWVZl9iZ5f3ffliTdfTjJnUnOrapK8reX45Lk55I8f/n+O5bX6+e9aNkfAADgpNsyeLr77iQ3ZW0VJ1lb3bmqu3t9n6p6epKzktye5NFJ7u3uzy+b70jy+OX7xyf55HLezyf5w2X/L1BVl1XVSlWtJHedyHUBAABs+6EFG29rO7C8TpJU1eOSvCXJpd19f5LNVmzW4+hY2x4Y6L6iu/d39/7k3G1OEQAA4AttN3iuy9rtZ09Lck5335wkVfXwJNcneU13f2jZ9zNJHllVe5bX5yU5vHx/R5K/uhy7J8kjknx2x1cBAACwiW0FT3ffl+TGJFdmWd1Znrx2bZI3d/fVG/btJO9L8p3L0Pckeefy/buW11m2/8rGW+MAAABOpuP5d3gOJnlqkrctr1+U5BlJLqmqQ8vXBcu2Vyd5VVV9LGuf0XnTMv6mJI9exl+V5H/f6QUAAAAcTZ3uCyxV+ztZ2e1pAABwgk7zv24yQFWtrn3+/8GOZ4UHAADgjCJ4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhrz25PYCv79iUrK7s9CwAA4ExkhQcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADG2rPbE9jK6mpStduzAABOpe7dngEwlRUeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAY52S4Kmqx1bV26rq9qr6aFXdUFVPqqp3V9W9VfWLp+J9AQAANtpzsk9YVZXk2iQ/190HlrELknxlksuTPDTJPzzZ7wsAAHCkkx48Sb4lyee6+6fXB7r70Pr3VfWsU/CeAAAAD3Iqbmn7hiSrOzlBVV1WVStVtZLcdZKmBQAAfKk5LR9a0N1XdPf+7t6fnLvb0wEAAM5QpyJ4bk2y7xScFwAA4LiciuD5lSRnV9XL1weq6sKqeuYpeC8AAICjOunB092d5AVJnr08lvrWJK9NcriqPpDk6iQXVdUdVXXxyX5/AACAdafiKW3p7sNJXrTJpm8+Fe8HAACwmdPyoQUAAAAng+ABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYKw9uz2Brezbl6ys7PYsAACAM5EVHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhrz25PYCurq0nVbs8CANhM927PAODYrPAAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAY65jBU1U3VtXFR4y9sqpuqKoPVtWtVXVLVb14k2PfWFX3bXj9qqr66LL/e6vqq0/eZQAAADzYVis8B5McOGLsQJLXJXlpdz8lyXOSvKGqHrm+Q1XtT/LII477jST7u/sbk1yT5F/uZOIAAABb2Sp4rkny3Ko6O0mq6vwke5O8v7tvS5LuPpzkziTnLvs8JMnlSf7pxhN19/u6+78tLz+U5LyTcwkAAACbO2bwdPfdSW7K2ipOsra6c1V39/o+VfX0JGcluX0Z+v4k7+ruTx/j1C9L8ktH21hVl1XVSlWtJHdtfRUAAACb2M5DCzbe1nZgeZ0kqarHJXlLkku7+/6q2pvkhUneeLSTVdV3J9mftVWgTXX3Fd29v7v3LwtHAAAAx207wXNdkouq6mlJzunum5Okqh6e5Pokr+nuDy37flOSJyT5WFX9bpKHVtXH1k9UVd+a5J8l+V+7+89P3mUAAAA82J6tduju+6rqxiRXZlndqaqzklyb5M3dffWGfa9P8tj111V1X3c/Yfn+m5L82yTP6e47T+ZFAAAAbGa7/w7PwSRPTfK25fWLkjwjySVVdWj5umCLc1ye5GFJrl72f9cJzRgAAGCbasPzB05LVfs7WdntaQAAmzjN/xoBfImoqtW1z/8/2HZXeAAAAM44ggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsfbs9gS2sm9fsrKy27MAAADORFZ4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYKw9uz2BrayuJlW7PQsAWNO92zMA4HhY4QEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADDWjoKnqh5bVW+rqtur6qNVdUNVPamq3l1V91bVLx6x/5uq6sNVdUtVXVNVD9vZ9AEAAI7uhIOnqirJtUlu7O6v7e6vT/IjSb4yyeVJXrLJYT/Y3U/t7m9M8vtJvv9E3x8AAGAre3Zw7Lck+Vx3//T6QHcfWv++qp515AHd/UfLtkpyTpLewfsDAAAc005uafuGJKvHe1BV/UyS/5rkyUneeJR9LquqlapaSe7awRQBAIAvZV/0hxZ096VJ9ib5rSQvPso+V3T3/u7en5z7RZ0fAAAwx06C59Yk+07kwO7+iyRXJfl7O3h/AACAY9pJ8PxKkrOr6uXrA1V1YVU9c7Oda80T1r9P8rwkv72D9wcAADimEw6e7u4kL0jy7OWx1LcmeW2Sw1X1gSRXJ7moqu6oqouTVJKfq6qPJPlIkscl+bGdXgAAAMDR1Fq3nL6q9neystvTAIAkyWn+xybAl6SqWl37/P+DfdEfWgAAAPDFIngAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGGvPbk9gK/v2JSsruz0LAADgTGSFBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFh7dnsCW1ldTap2exYAfKnp3u0ZAHAyWOEBAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsXYUPFX12Kp6W1XdXlUfraobqupJVfXuqrq3qn7xiP3fWlW/U1W/WVVXVtWX72z6AAAAR3fCwVNVleTaJDd299d299cn+ZEkX5nk8iQv2eSwtyZ5cpK/nuScJN97ou8PAACwlT07OPZbknyuu396faC7D61/X1XPOvKA7r5hw/abkpy3g/cHAAA4pp3c0vYNSVZP5MDlVraXJHn3Dt4fAADgmHbroQX/Osn7u/sDm22sqsuqaqWqVpK7vshTAwAApthJ8NyaZN/xHlRVP5rk3CSvOto+3X1Fd+/v7v1ruwIAABy/nQTPryQ5u6pevj5QVRdW1TOPdkBVfW+Si5N8V3ffv4P3BgAA2NIJB093d5IXJHn28ljqW5O8NsnhqvpAkquTXFRVd1TVxcthP521p7h9sKoOVdX/sbPpAwAAHN1OntKW7j6c5EWbbPrmo+y/o/cDAAA4Hrv10AIAAIBTTvAAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHACJuCzoAACAASURBVAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxtqz2xPYyr59ycrKbs8CAAA4E1nhAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLH27PYEtrK6mlTt9iwAOBN07/YMADjdWOEBAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsbYMnqq6saouPmLslVV1Q1V9sKpurapbqurFmxz7xqq6b8PrV1TVR6rqUFX9alV9/cm5DAAAgAfbzgrPwSQHjhg7kOR1SV7a3U9J8pwkb6iqR67vUFX7kzzyiON+obv/endfkORfJvnJE545AADAFrYTPNckeW5VnZ0kVXV+kr1J3t/dtyVJdx9OcmeSc5d9HpLk8iT/dOOJuvuPNrz8y0l6Z9MHAAA4ui2Dp7vvTnJT1lZxkrXVnau6+3/ESlU9PclZSW5fhr4/ybu6+9NHnq+qvq+qbs/aCs8P7Gz6AAAAR7fdhxZsvK3twPI6SVJVj0vyliSXdvf9VbU3yQuTvHGzE3X3/9PdX5vk1Ules9k+VXVZVa1U1Upy1zanCAAA8IVqw0LN0XeqeliSj2dtledgd3/dMv7wJDcm+YnuvnoZ+/Ykb0ryZ8vhX5Xk4939hCPO+WVJ7unuRxz7vfd3snI81wTAl6ht/JEGwEBVtdrd+zfbtmc7J+ju+6rqxiRXZlndqaqzklyb5M3rsbPse32Sx2548/vWY6eqnrj+uZ8k355k/XsAAICTblvBsziY5B154Na2FyV5RpJHV9Uly9gl3X3oGOf4/qr61iSfS3JPku85vukCAABs37ZuadtNbmkDYLtO8z/SADhFjnVL23YfWgAAAHDGETwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsfbs9gS2sm9fsrKy27MAAADORFZ4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYCzBAwAAjCV4AACAsQQPAAAwluABAADGEjwAAMBYggcAABhL8AAAAGMJHgAAYKw9uz2BrayuJlW7PQsAzgTduz0DAE43VngAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgLMEDAACMJXgAAICxBA8AADCW4AEAAMYSPAAAwFiCBwAAGEvwAAAAYwkeAABgrGMGT1XdWFUXHzH2yqr611X17qq6t6p+8YjtF1XVzVV1qKp+taqesIx/dVW9t6puWc573sm/HAAAgAdstcJzMMmBI8YOLOOXJ3nJJsf8myR/v7svSPILSV6zjP+rJG/u7m9M8mNJfuJEJw0AALAdWwXPNUmeW1VnJ0lVnZ9kb5Jf7e73JvnjTY7pJA9fvn9EksPL91+f5L3L9+9L8h0nPGsAAIBtOGbwdPfdSW5K8pxl6ECSq7q7j3HY9ya5oaruyNoK0L9Yxj+c5O8t378gyVdU1aNPdOIAAABb2c5DCzbe1rZ+O9ux/GCSb+vu85L8TJKfXMb/SZJnVtVvJHlmkk8l+fxmJ6iqy6pqpapWkru2MUUAAIAH207wXJfkoqp6WpJzuvvmo+1YVecmeWp3//oydFWSv5kk3X24u/9ud39Tkn+2jP3hZufp7iu6e39370/OPY7LAQAAeMCWwdPd9yW5McmV2Xp1554kj6iqJy2vn53kt5Kkqh5TVevv98PL+QAAAE6ZPdvc72CSd2TDE9uq6gNJnpzkYcvndV7W3e+pqpcneXtV3Z+1APoHyyHPSvITVdVJ3p/k+07OJQAAAGyujv38gd1Xtb+Tld2eBgBngNP8jzQATpGqWl37OMyDbeczPAAAAGckwQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYS/AAAABjCR4AAGAswQMAAIwleAAAgLEEDwAAMJbgAQAAxhI8AADAWIIHAAAYa89uT2Ar+/YlKyu7PQsAAOBMZIUHAAAYS/AAAABjCR4AAGAswQMAAIwleAD4/9m7+yBN6/rO958vDDBEFIMShYxxNApo5HGGKR8KlRCBdcmmPCKOcbOLUYnLkUQra8LuSerkVM6ekzoaMcv6EFYNiauIEMWsEtGoo2JMoAcRg6CAIckEKxLiA/i0IL/zR9+NY9sz3TM9w93znderqmu6r/u67ut7d3XN8OZ33VcDQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAba2a9gCL2bw5qZr2FACsZGNMewIAViorPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANDWosFTVZuq6rR5215VVVdW1Weq6saquqGqXrjAsRdW1T0LbD+zqkZVrV/e+AAAANu2agn7XJJkY5Krttq2MclvJrljjHFLVR2eZHNVXTXG+HqSTGLm4fOfrKoemuRXk/z1cocHAADYnqVc0nZ5kjOq6oAkqaq1SQ5P8skxxi1JMsa4I8lXkxw62WffJK9N8hsLPN/vJvn/knx3mbMDAABs16LBM8a4K8k1SU6fbNqY5NIxxpjbp6o2JNk/yW2TTa9M8mdjjK9s/VxVdXySx4wxPrALZgcAANiupd60YO6ytkz+vGTugao6LMk7krxkjHH/5PK2FyS5cOsnqKp9klyQ5NcXO1lVnVNVM1U1k9y5xBEBAAB+WG21ULPtnaoOSvLlzK7yXDLGOHKy/WFJNiX5f8cYl022/eskb8sPLln7qcmx6zK7AjR3E4NHJ/mXJP9mjDGz7XOvH8k2HwaALOGfMgAaq6rNY4wFb4i2lJsWZIxxT1VtSvL2TFZ3qmr/JO9L8idzsTPZ94OZjZm5k98zxnjC5MtHbrV9U5L/uL3YAQAAWI4d+T08lyQ5Nsm7J1+fleSZSc6uqusnH8ft6gEBAAB21pIuaZsml7QBsJgV/k8ZALvZ9i5p25EVHgAAgD2K4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0tWraAyxm3bpkZmbaUwAAAHsiKzwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQ1qppD7CYzZuTqmlPAcBKMsa0JwBgT2GFBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANpaVvBU1aOr6t1VdVtVfaGqrqyqI6rqQ1X19ar6wDaOu7Cq7lnOuQEAABazamcPrKpK8r4kfzzG2DjZdlySRyV5bZIfS/IrCxy3PsnDd/a8AAAAS7XTwZPk5CT3jjHeMrdhjHH93OdV9ez5B1TVvpmNoV9M8rxlnBsAAGBRy7mk7SlJNu/gMa9M8mdjjK8s47wAAABLspwVnh1SVYcneUGSZy9h33OSnDP71U/tzrEAAIDGlrPCc2OSdTuw//FJnpDk1qq6PcmPVdWtC+04xrhojLF+jLE+OXQZIwIAAHuz5QTPx5IcUFUvn9tQVSdW1bMW2nmM8cExxqPHGGvHGGuTfHuM8YRlnB8AAGC7djp4xhgjszceeM7kttQ3JvmdJHdU1aeSXJbklKraUlWn7ZJpAQAAdsCy3sMzxrgjyVkLPHTSEo49aDnnBgAAWMyyfvEoAADASiZ4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG2tmvYAi1m3LpmZmfYUAADAnsgKDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALS1atoDLGbz5qRq2lMA8GAbY9oTANCBFR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtbTd4qmpTVZ02b9urqurKqvpMVd1YVTdU1QsXOPbCqrpn3razquoLk+PetWteAgAAwMJWLfL4JUk2Jrlqq20bk/xmkjvGGLdU1eFJNlfVVWOMrydJVa1P8vCtn6iqnpjkPyV5xhjja1X1E7vqRQAAACxksUvaLk9yRlUdkCRVtTbJ4Uk+Oca4JUnGGHck+WqSQyf77JvktUl+Y95zvTzJG8cYX5sc99Vd8xIAAAAWtt3gGWPcleSaJKdPNm1McukYY8ztU1Ubkuyf5LbJplcm+bMxxlfmPd0RSY6oqk9X1V9V1enZhqo6p6pmqmomuXPHXhEAAMDEUm5aMHdZWyZ/XjL3QFUdluQdSV4yxrh/cnnbC5JcuMDzrEryxCTPTvKiJG+tqocvsF/GGBeNMdaPMdZPFo4AAAB22FKC54okp1TVCUkOHGNclyRV9bAkH0zyW2OMv5rse3ySJyS5tapuT/JjVXXr5LEtSd4/xrh3jPG3Sb6Y2QACAADYLRYNnjHGPUk2JXl7Jqs7VbV/kvcl+ZMxxmVb7fvBMcajxxhrxxhrk3x7jPGEycNXJDl5cvwjM3uJ25d33UsBAAD4YUv9PTyXJDk2ybsnX5+V5JlJzq6q6ycfxy3yHFcluauqvpDk40leM3mPEAAAwG5RW91/YEWqWj+SmWmPAcCDbIX/8wTAClJVm2ff//+jlrrCAwAAsMcRPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0tWraAyxm3bpkZmbaUwAAAHsiKzwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQ1qppD7CYzZuTqmlPAcC2jDHtCQBg26zwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaGvV7njSqnp0kjckOTHJ95LcnuT9Sf7DVrsdlWTjGOOK3TEDAADALg+eqqok70vyx2OMjZNtxyV56BjjuMnXhyS5NcmHd/X5AQAA5uyOFZ6Tk9w7xnjL3IYxxvXz9jkzyZ+PMb69G84PAACQZPe8h+cpSTYvss/GJJds68GqOqeqZqpqJrlzlw4HAADsPR70mxZU1WFJjk5y1bb2GWNcNMZYP8ZYnxz64A0HAAC0sjuC58Yk67bz+FlJ3jfGuHc3nBsAAOABuyN4PpbkgKp6+dyGqjqxqp41+fJF2c7lbAAAALvKLg+eMcZI8rwkz6mq26rqxiS/k+SOqlqb5DFJPrGrzwsAADDfbvk9PGOMOzJ76dpCfnJ3nBMAAGC+B/2mBQAAAA8WwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW6umPcBi1q1LZmamPQUAALAnssIDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAba2a9gCL2bw5qZr2FAC71hjTngAA9g5WeAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALS108FTVZuq6rR5215VVW+afP6wqvrHqvpv8475YlVdP/n4iZ0fHQAAYPuWs8JzSZKN87ZtnGxPkt9N8okFjnvxGOO4ycdXl3F+AACA7VpO8Fye5IyqOiBJqmptksOTXF1V65I8KsmHlzsgAADAztrp4Blj3JXkmiSnTzZtTHJpkkry+0les41D/2hyOdtvV1UttENVnVNVM1U1k9y5syMCAAB7ueXetGDry9rmLmc7N8mVY4x/WGD/F48xjk5y0uTjlxZ60jHGRWOM9WOM9cmhyxwRAADYWy03eK5IckpVnZDkwDHGdUmeluSVVXV7ktcl+XdV9XtJMsb4x8mfdyd5V5INyzw/AADANq1azsFjjHuqalOSt2dys4IxxovnHq+qs5OsH2OcX1Wrkjx8jPHPVbVfkjOS/MVyzg8AALA9ywqeiUuSvDc/ese2+Q5IctUkdvbNbOz8911wfgAAgAXVGGPaM2xX1fqRzEx7DIBdaoX/1QsAe5Sq2jz7/v8ftdz38AAAAKxYggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtlZNe4DFrFuXzMxMewoAAGBPZIUHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2lo17QEWs3lzUjXtKYC93RjTngAA2BlWeAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALS13eCpqk1Vddq8ba+qqjdV1Yeq6utV9YF5j59SVddV1fVVdXVVPWGy/YLJtuur6ktV9fVd/3IAAAB+YNUij1+SZGOSq7batjHJa5Lsn+THkvzKvGPenOQXxhg3VdW5SX4rydljjFfP7VBV5yU5fpmzAwAAbNdil7RdnuSMqjogSapqbZLDk1w9xvhokrsXOGYkedjk84OT3LHAPi/KbEwBAADsNttd4Rlj3FVV1yQ5Pcn7M7u6c+kYY2znsJclubKqvpPkm0meuvWDVfXYJI9L8rFtPUFVnZPknNmvfmrRFwEAALCQpdy0YO6ytkz+XGxl5tVJnjvGWJPkj5K8ft7jG5NcPsb4/raeYIxx0Rhj/RhjfXLoEkYEAAD4UUsJniuSnFJVJyQ5cIxx3bZ2rKpDkxw7xvjryaZLkzx93m5LiSYAAIBlWzR4xhj3JNmU5O1ZPFS+luTgqjpi8vVzktw092BVHZnkx5N8ZmeGBQAA2BGL3aVtziVJ3psfXNqWqvpUkqOSHFRVW5K8dIxxVVW9PMmfVtX9mQ2gX97qeV6U5N2LvAcIAABgl6iV3h5V60cyM+0xgL3cCv+rEgD2alW1efb9/z9qKe/hAQAA2CMJHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaWjXtARazbl0yMzPtKQAAgD2RFR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoa9W0B1jM5s1J1bSnAPYmY0x7AgBgV7HCAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoK3tBk9Vbaqq0+Zte1VVvamqPlRVX6+qD8x7/Ger6rqq+puq+uOqWjXZ/uNV9b6quqGqrqmqp+z6lwMAAPADi63wXJJk47xtGyfbX5vkl7Z+oKr2SfLHSTaOMZ6S5O+S/PvJw/85yfVjjGOS/Lskf7C80QEAALZvseC5PMkZVXVAklTV2iSHJ7l6jPHRJHfP2/8RSb43xvjS5OuPJHn+5PMnJ/lokowxbk6ytqoetdwXAAAAsC3bDZ4xxl1Jrkly+mTTxiSXjjHGNg755yT7VdX6yddnJnnM5PPPJfnfkqSqNiR5bJI1Oz86AADA9i3lpgVbX9Y2dznbgiYhtDHJBVV1TWZXgO6bPPx7SX68qq5Pcl6Sz2712A+pqnOqaqaqZpI7l/RCAAAA5lu1hH2uSPL6qjohyYFjjOu2t/MY4zNJTkqSqjo1yRGT7d9M8pLJ9kryt5OPhZ7joiQXze67flurSQAAANu16ArPGOOeJJuSvD3bWd2ZU1U/MfnzgCS/meQtk68fXlX7T3Z7WZJPTiIIAABgt1jq7+G5JMmxSd49t6GqPpXksiSnVNWWrW5f/ZqquinJDUn+5xjjY5PtT0pyY1XdnORfJfm1XfECAAAAtqW2ff+BlWH2kraZaY8B7EVW+F+LAMA8VbV5jLF+oceWusIDAACwxxE8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLZWTXuAxaxbl8zMTHsKAABgT2SFBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2CvMNuwAAEuxJREFUBA8AANCW4AEAANpaNe0BFrN5c1I17SmAPdkY054AAJgWKzwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQ1m4Lnqp6dFW9u6puq6ovVNWVVXXE5LGHVdU/VtV/213nBwAA2C3BU1WV5H1JNo0xfnqM8eQk/znJoya7/G6ST+yOcwMAAMxZtZue9+Qk944x3jK3YYxxfZJU1brMhs+HkqzfTecHAADYbZe0PSXJ5vkbq2qfJL+f5DW76bwAAAAPeLBvWnBukivHGP+wvZ2q6pyqmqmqmeTOB2k0AACgm911SduNSc5cYPvTkpxUVecmOSjJ/lV1zxjj/K13GmNclOSiJKlaP3bTjAAAQHO7a4XnY0kOqKqXz22oqhOTXDTG+Kkxxtok/zHJn8yPHQAAgF1ltwTPGGMkeV6S50xuS31jkt9JcsfuOB8AAMBCarZNVq7ZS9pmpj0GsAdb4X/NAQDLVFWbxxgL3gH6wb5pAQAAwING8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaEjwAAEBbggcAAGhL8AAAAG0JHgAAoC3BAwAAtCV4AACAtgQPAADQluABAADaWjXtARazbl0yMzPtKQAAgD2RFR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoa9W0B1jM5s1J1bSnAKZtjGlPAADsiazwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuCBwAAaEvwAAAAbQkeAACgLcEDAAC0JXgAAIC2BA8AANCW4AEAANoSPAAAQFuLBk9Vbaqq0+Zte1VVvamqPlRVX6+qD8x7/JSquq6qrq+qq6vqCZPtP1VVH6+qz1bVDVX13F37cgAAAH5gKSs8lyTZOG/bxsn21yb5pQWOeXOSF48xjkvyriS/Ndn+W0neM8Y4fvIcb9qZoQEAAJZiKcFzeZIzquqAJKmqtUkOT3L1GOOjSe5e4JiR5GGTzw9Ocsci2wEAAHa5VYvtMMa4q6quSXJ6kvdndmXm0jHG2M5hL0tyZVV9J8k3kzx1sv13kny4qs5L8pAkP7eM2QEAALZrqTct2PqytrnL2bbn1UmeO8ZYk+SPkrx+sv1FSS6ebH9ukndU1Y/MUFXnVNVMVc0kdy5xRAAAgB+21OC5IskpVXVCkgPHGNdta8eqOjTJsWOMv55sujTJ0yefvzTJe5JkjPGZJKuTPHL+c4wxLhpjrB9jrE8OXeKIAAAAP2xJwTPGuCfJpiRvz+KrO19LcnBVHTH5+jlJbpp8/vdJTkmSqnpSZoPHEg4AALBbLPoenq1ckuS92eqObVX1qSRHJTmoqrYkeekY46qqenmSP62q+zMbQL88OeTXk/z3qnp1Zm9gcPYi7wUCAADYabXSe6Nq/Uhmpj0GMGUr/K8qAGCKqmrz7NthftRS38MDAACwxxE8AABAW4IHAABoS/AAAABtCR4AAKAtwQMAALQleAAAgLYEDwAA0JbgAQAA2hI8AABAW4IHAABoS/AAAABtrZr2AAAAsCe79957s2XLlnz3u9+d9ijtrV69OmvWrMl+++235GMEDwAALMOWLVvy0Ic+NGvXrk1VTXuctsYYueuuu7Jly5Y87nGPW/JxLmkDAIBl+O53v5tHPOIRYmc3q6o84hGP2OGVtBW/wrNuXTIzM+0pAABg28TOg2Nnvs9WeAAAYA930EEHPajnu/322/Oud73rQT3nzhI8AACwC1Xt2o+V5r777hM8AADAg2/Tpk151rOelbPOOitHHHFEzj///Lzzne/Mhg0bcvTRR+e2225Lkpx99tl5xStekZNOOilHHHFEPvCBDySZfT/SS17ykhx99NE5/vjj8/GPfzxJcvHFF+cFL3hBfv7nfz6nnnpqzj///HzqU5/KcccdlwsuuCC33357TjrppJxwwgk54YQT8pd/+ZcPzPPsZz87Z555Zo466qi8+MUvzhgjSXLttdfm6U9/eo499ths2LAhd999d77//e/nNa95TU488cQcc8wx+cM//MNlf09W/Ht4AACApfvc5z6Xm266KYccckge//jH52Uve1muueaa/MEf/EEuvPDCvOENb0gye1naJz7xidx22205+eSTc+utt+aNb3xjkuTzn/98br755px66qn50pe+lCT5zGc+kxtuuCGHHHJINm3alNe97nUPhNK3v/3tfOQjH8nq1atzyy235EUvelFmJm/E/+xnP5sbb7wxhx9+eJ7xjGfk05/+dDZs2JAXvvCFufTSS3PiiSfmm9/8Zg488MC87W1vy8EHH5xrr7023/ve9/KMZzwjp5566g7dlW0+wQMAAI2ceOKJOeyww5IkP/3TP51TTz01SXL00Uc/sGKTJGeddVb22WefPPGJT8zjH//43Hzzzbn66qtz3nnnJUmOOuqoPPaxj30geJ7znOfkkEMOWfCc9957b175ylfm+uuvz7777vvAMUmyYcOGrFmzJkly3HHH5fbbb8/BBx+cww47LCeeeGKS5GEPe1iS5MMf/nBuuOGGXH755UmSb3zjG7nlllsEDwAAMOuAAw544PN99tnnga/32Wef3HfffQ88Nv+OZ1X1wOVmC3nIQx6yzccuuOCCPOpRj8rnPve53H///Vm9evWC8+y777657777MsZY8I5rY4xceOGFOe2007bzCneM9/AAAMBe6LLLLsv999+f2267LV/+8pdz5JFH5pnPfGbe+c53Jkm+9KUv5e///u9z5JFH/sixD33oQ3P33Xc/8PU3vvGNHHbYYdlnn33yjne8I9///ve3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\n",
      "text/plain": [
       "<Figure size 1008x2016 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "importance_feature = pd.DataFrame(index=X_train.columns)\n",
    "importance_feature['Importance'] = rf_tuned.feature_importances_ * 100\n",
    "importance_feature.loc[importance_feature['Importance'] > 1.5].sort_values('Importance').head(40).plot(kind='barh', figsize=(14, 28), color='blue', title='Feature Importance')\n",
    "plt.xlabel('Variable Severity Levels')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import confusion_matrix, classification_report\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "cm = confusion_matrix(Y_val, rf_tuned.predict(X_val).round())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.heatmap(cm, annot=True, fmt='.0f')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.97      0.99      0.98    113934\n",
      "           1       0.99      0.97      0.98    114017\n",
      "\n",
      "    accuracy                           0.98    227951\n",
      "   macro avg       0.98      0.98      0.98    227951\n",
      "weighted avg       0.98      0.98      0.98    227951\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(Y_val, rf_tuned.predict(X_val).round()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "metadata": {},
   "outputs": [],
   "source": [
    "cm_full = confusion_matrix(Y_train, clf.predict_proba(X_train)[:,1].round())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.heatmap(cm_full, annot=True, fmt='.0f')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.98      0.99      0.99    113866\n",
      "           1       0.74      0.40      0.52      4242\n",
      "\n",
      "    accuracy                           0.97    118108\n",
      "   macro avg       0.86      0.70      0.75    118108\n",
      "weighted avg       0.97      0.97      0.97    118108\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(Y_val, clf.predict_proba(X_val)[:,1].round()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>isFraud</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TransactionID</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3663549</th>\n",
       "      <td>0.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3663550</th>\n",
       "      <td>0.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3663551</th>\n",
       "      <td>0.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3663552</th>\n",
       "      <td>0.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3663553</th>\n",
       "      <td>0.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               isFraud\n",
       "TransactionID         \n",
       "3663549            0.5\n",
       "3663550            0.5\n",
       "3663551            0.5\n",
       "3663552            0.5\n",
       "3663553            0.5"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sample_submission.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred = rf_tuned.predict(X_val)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TransactionDT</th>\n",
       "      <th>TransactionAmt</th>\n",
       "      <th>ProductCD</th>\n",
       "      <th>card1</th>\n",
       "      <th>card2</th>\n",
       "      <th>card3</th>\n",
       "      <th>card4</th>\n",
       "      <th>card5</th>\n",
       "      <th>card6</th>\n",
       "      <th>addr1</th>\n",
       "      <th>...</th>\n",
       "      <th>V330</th>\n",
       "      <th>V331</th>\n",
       "      <th>V332</th>\n",
       "      <th>V333</th>\n",
       "      <th>V334</th>\n",
       "      <th>V335</th>\n",
       "      <th>V336</th>\n",
       "      <th>V337</th>\n",
       "      <th>V338</th>\n",
       "      <th>V339</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>TransactionID</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3663549</th>\n",
       "      <td>18403224</td>\n",
       "      <td>31.950</td>\n",
       "      <td>4</td>\n",
       "      <td>10409</td>\n",
       "      <td>111.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>4</td>\n",
       "      <td>226.0</td>\n",
       "      <td>3</td>\n",
       "      <td>170.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3663550</th>\n",
       "      <td>18403263</td>\n",
       "      <td>49.000</td>\n",
       "      <td>4</td>\n",
       "      <td>4272</td>\n",
       "      <td>111.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>4</td>\n",
       "      <td>226.0</td>\n",
       "      <td>3</td>\n",
       "      <td>299.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3663551</th>\n",
       "      <td>18403310</td>\n",
       "      <td>171.000</td>\n",
       "      <td>4</td>\n",
       "      <td>4476</td>\n",
       "      <td>574.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>4</td>\n",
       "      <td>226.0</td>\n",
       "      <td>3</td>\n",
       "      <td>472.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3663552</th>\n",
       "      <td>18403310</td>\n",
       "      <td>284.950</td>\n",
       "      <td>4</td>\n",
       "      <td>10989</td>\n",
       "      <td>360.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>4</td>\n",
       "      <td>166.0</td>\n",
       "      <td>3</td>\n",
       "      <td>205.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3663553</th>\n",
       "      <td>18403317</td>\n",
       "      <td>67.950</td>\n",
       "      <td>4</td>\n",
       "      <td>18018</td>\n",
       "      <td>452.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>3</td>\n",
       "      <td>117.0</td>\n",
       "      <td>3</td>\n",
       "      <td>264.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4170235</th>\n",
       "      <td>34214279</td>\n",
       "      <td>94.679</td>\n",
       "      <td>0</td>\n",
       "      <td>13832</td>\n",
       "      <td>375.0</td>\n",
       "      <td>185.0</td>\n",
       "      <td>3</td>\n",
       "      <td>224.0</td>\n",
       "      <td>3</td>\n",
       "      <td>284.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4170236</th>\n",
       "      <td>34214287</td>\n",
       "      <td>12.173</td>\n",
       "      <td>0</td>\n",
       "      <td>3154</td>\n",
       "      <td>408.0</td>\n",
       "      <td>185.0</td>\n",
       "      <td>3</td>\n",
       "      <td>224.0</td>\n",
       "      <td>3</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4170237</th>\n",
       "      <td>34214326</td>\n",
       "      <td>49.000</td>\n",
       "      <td>4</td>\n",
       "      <td>16661</td>\n",
       "      <td>490.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>4</td>\n",
       "      <td>226.0</td>\n",
       "      <td>3</td>\n",
       "      <td>327.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4170238</th>\n",
       "      <td>34214337</td>\n",
       "      <td>202.000</td>\n",
       "      <td>4</td>\n",
       "      <td>16621</td>\n",
       "      <td>516.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>3</td>\n",
       "      <td>224.0</td>\n",
       "      <td>3</td>\n",
       "      <td>177.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4170239</th>\n",
       "      <td>34214345</td>\n",
       "      <td>24.346</td>\n",
       "      <td>0</td>\n",
       "      <td>5713</td>\n",
       "      <td>168.0</td>\n",
       "      <td>144.0</td>\n",
       "      <td>4</td>\n",
       "      <td>147.0</td>\n",
       "      <td>2</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>...</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>506691 rows Ã— 392 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               TransactionDT  TransactionAmt  ProductCD  card1  card2  card3  \\\n",
       "TransactionID                                                                  \n",
       "3663549             18403224          31.950          4  10409  111.0  150.0   \n",
       "3663550             18403263          49.000          4   4272  111.0  150.0   \n",
       "3663551             18403310         171.000          4   4476  574.0  150.0   \n",
       "3663552             18403310         284.950          4  10989  360.0  150.0   \n",
       "3663553             18403317          67.950          4  18018  452.0  150.0   \n",
       "...                      ...             ...        ...    ...    ...    ...   \n",
       "4170235             34214279          94.679          0  13832  375.0  185.0   \n",
       "4170236             34214287          12.173          0   3154  408.0  185.0   \n",
       "4170237             34214326          49.000          4  16661  490.0  150.0   \n",
       "4170238             34214337         202.000          4  16621  516.0  150.0   \n",
       "4170239             34214345          24.346          0   5713  168.0  144.0   \n",
       "\n",
       "               card4  card5  card6  addr1  ...   V330   V331   V332   V333  \\\n",
       "TransactionID                              ...                               \n",
       "3663549            4  226.0      3  170.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "3663550            4  226.0      3  299.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "3663551            4  226.0      3  472.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "3663552            4  166.0      3  205.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "3663553            3  117.0      3  264.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "...              ...    ...    ...    ...  ...    ...    ...    ...    ...   \n",
       "4170235            3  224.0      3  284.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "4170236            3  224.0      3 -999.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "4170237            4  226.0      3  327.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "4170238            3  224.0      3  177.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "4170239            4  147.0      2 -999.0  ... -999.0 -999.0 -999.0 -999.0   \n",
       "\n",
       "                V334   V335   V336   V337   V338   V339  \n",
       "TransactionID                                            \n",
       "3663549       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "3663550       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "3663551       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "3663552       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "3663553       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "...              ...    ...    ...    ...    ...    ...  \n",
       "4170235       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "4170236       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "4170237       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "4170238       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "4170239       -999.0 -999.0 -999.0 -999.0 -999.0 -999.0  \n",
       "\n",
       "[506691 rows x 392 columns]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "sample_submission['isFraud'] = clf.predict_proba(X_test)[:,1]\n",
    "sample_submission.to_csv('fraud-detection-submission_XGB.csv')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
